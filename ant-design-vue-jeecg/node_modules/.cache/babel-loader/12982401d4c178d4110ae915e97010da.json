{"remainingRequest":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\activiti\\todoManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\activiti\\todoManage.vue","mtime":1611914356000},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1621061372054}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin';\nimport { activitiMixin } from '@/views/activiti/mixins/activitiMixin';\nimport JSelectUserByDep from '@/components/jeecgbiz/JSelectUserByDep';\nexport default {\n  name: \"todo-manage\",\n  mixins: [activitiMixin, JeecgListMixin],\n  components: {\n    JSelectUserByDep: JSelectUserByDep\n  },\n  data: function data() {\n    return {\n      openSearch: true,\n      openTip: true,\n      loading: true,\n      // 表单加载状态\n      modalTaskVisible: false,\n      userLoading: false,\n      backLoading: false,\n      selectCount: 0,\n      // 多选计数\n      selectList: [],\n      // 多选数据\n      assigneeList: [],\n      backList: [{\n        key: \"-1\",\n        name: \"发起人\"\n      }],\n      error: \"\",\n      showAssign: false,\n      searchForm: {\n        // 搜索框对应data对象\n        name: \"\"\n      },\n      modalTaskTitle: \"\",\n      modalTitle: \"\",\n      // 添加或编辑标题\n      form: {\n        id: \"\",\n        userId: \"\",\n        procInstId: \"\",\n        comment: \"\",\n        type: 0,\n        assignees: [],\n        backTaskKey: \"-1\",\n        sendMessage: true,\n        sendSms: false,\n        sendEmail: false\n      },\n      formValidate: {// 表单验证规则\n      },\n      submitLoading: false,\n      // 添加或编辑提交状态\n      data: [],\n      // 表单数据\n      total: 0,\n      // 表单数据总数\n      dictPriority: [],\n      isGateway: false,\n      lcModa: {\n        title: '',\n        disabled: false,\n        visible: false,\n        formComponent: null,\n        isNew: false\n      },\n      url: {\n        todoList: '/actTask/todoList',\n        pass: '/actTask/pass',\n        back: '/actTask/back',\n        backToTask: '/actTask/backToTask',\n        delegate: '/actTask/delegate',\n        getNextNode: '/activiti_process/getNextNode',\n        getNode: '/activiti_process/getNode/',\n        getBackList: '/actTask/getBackList/',\n        passAll: '/actTask/passAll/',\n        backAll: '/actTask/backAll/'\n      },\n\n      /*历史*/\n      modalLsVisible: false,\n      procInstId: ''\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  methods: {\n    init: function init() {\n      this.getDataList();\n    },\n    loadData: function loadData() {},\n    getDataList: function getDataList() {\n      var _this = this;\n\n      this.loading = true;\n      this.getAction(this.url.todoList, this.searchForm).then(function (res) {\n        _this.loading = false;\n\n        if (res.success) {\n          _this.data = res.result || [];\n          _this.total = _this.data.leading;\n        }\n      });\n    },\n    handleTableChange: function handleTableChange(pagination, filters, sorter) {\n      //分页、排序、筛选变化时触发\n      if (Object.keys(sorter).length > 0) {\n        this.isorter.column = sorter.field;\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\";\n      }\n\n      this.ipagination = pagination; // this.loadData();\n    },\n    handleSearch: function handleSearch() {\n      this.getDataList();\n    },\n    handleReset: function handleReset() {\n      this.searchForm = {}; // 重新加载数据\n\n      this.getDataList();\n    },\n    showSelect: function showSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n\n    /*审批提交的方法*/\n    handelSubmit: function handelSubmit() {\n      var _this2 = this;\n\n      console.log(\"提交\");\n      this.submitLoading = true;\n      var formData = Object.assign({}, this.form);\n      formData.assignees = formData.assignees.join(\",\");\n\n      if (formData.type == 0) {\n        // 通过\n        if (this.showAssign && formData.assignees.length < 1) {\n          this.$message.error(\"请至少选择一个审批人\");\n          this.submitLoading = false;\n          return;\n        } else {\n          this.error = \"\";\n        }\n\n        this.postFormAction(this.url.pass, formData).then(function (res) {\n          _this2.submitLoading = false;\n\n          if (res.success) {\n            _this2.lcModa.visible = false;\n\n            _this2.$message.success(\"操作成功\");\n\n            _this2.modalTaskVisible = false;\n\n            _this2.getDataList();\n          }\n        });\n      } else if (formData.type == 1) {\n        // 驳回\n        if (formData.backTaskKey == \"-1\") {\n          // 驳回至发起人\n          this.postFormAction(this.url.back, formData).then(function (res) {\n            _this2.submitLoading = false;\n\n            if (res.success) {\n              _this2.lcModa.visible = false;\n\n              _this2.$message.success(\"操作成功\");\n\n              _this2.modalTaskVisible = false;\n\n              _this2.getDataList();\n            }\n          });\n        } else {\n          // 自定义驳回\n          if (formData.backTaskKey != \"-1\" && formData.assignees.length < 1) {\n            this.$message.error(\"请至少选择一个审批人\");\n            this.submitLoading = false;\n            return;\n          } else {\n            this.error = \"\";\n          }\n\n          this.postFormAction(this.url.backToTask, formData).then(function (res) {\n            _this2.submitLoading = false;\n\n            if (res.success) {\n              _this2.lcModa.visible = false;\n\n              _this2.$message.success(\"操作成功\");\n\n              _this2.modalTaskVisible = false;\n\n              _this2.getDataList();\n            }\n          });\n        }\n      } else if (formData.type == 2) {\n        // 委托\n        if (!formData.userId) {\n          this.$message.error(\"请选择一委托人\");\n          this.submitLoading = false;\n          return;\n        } else {\n          this.error = \"\";\n        }\n\n        this.postFormAction(this.url.delegate, formData).then(function (res) {\n          _this2.submitLoading = false;\n\n          if (res.success) {\n            _this2.$message.success(\"操作成功\");\n\n            _this2.modalTaskVisible = false;\n\n            _this2.getDataList();\n          }\n        });\n      }\n    },\n    detail: function detail(r) {\n      if (!r.routeName) {\n        this.$message.warning(\"该流程信息未配置表单，请联系开发人员！\");\n        return;\n      }\n\n      this.lcModa.disabled = true;\n      this.lcModa.title = '查看流程业务信息：' + r.processName;\n      this.lcModa.formComponent = this.getFormComponent(r.routeName).component;\n      this.lcModa.processData = r;\n      this.lcModa.isNew = false;\n      this.lcModa.visible = true;\n    },\n    passTask: function passTask(v) {\n      var _this3 = this;\n\n      this.modalTaskTitle = \"审批通过\";\n      this.form.id = v.id;\n      this.form.procInstId = v.procInstId;\n      this.form.priority = v.priority;\n      this.form.type = 0;\n      this.modalTaskVisible = true;\n      this.userLoading = true;\n      this.getAction(this.url.getNextNode, {\n        procDefId: v.procDefId,\n        currActId: v.key\n      }).then(function (res) {\n        _this3.userLoading = false;\n\n        if (res.success) {\n          if (res.result.type == 4) {\n            _this3.isGateway = true;\n            _this3.showAssign = false;\n            _this3.error = \"\";\n            return;\n          }\n\n          _this3.isGateway = false;\n\n          if (res.result.users && res.result.users.length > 0) {\n            _this3.error = \"\";\n            _this3.assigneeList = res.result.users;\n            console.log(_this3.assigneeList); // 默认勾选\n\n            var ids = [];\n            res.result.users.forEach(function (e) {\n              ids.push(e.username);\n            });\n            _this3.form.assignees = ids;\n            _this3.showAssign = true;\n          } else {\n            _this3.form.assignees = [];\n            _this3.showAssign = false;\n          }\n        }\n      });\n    },\n    changeBackTask: function changeBackTask(v) {\n      var _this4 = this;\n\n      if (v == \"-1\") {\n        return;\n      }\n\n      this.userLoading = true;\n      this.getAction(this.url.getNode + v).then(function (res) {\n        _this4.userLoading = false;\n\n        if (res.success) {\n          if (res.result.users && res.result.users.length > 0) {\n            _this4.assigneeList = res.result.users; // 默认勾选\n\n            var ids = [];\n            res.result.users.forEach(function (e) {\n              ids.push(e.username);\n            });\n            _this4.form.assignees = ids;\n          }\n        }\n      });\n    },\n    backTask: function backTask(v) {\n      var _this5 = this;\n\n      this.modalTaskTitle = \"审批驳回\";\n      this.form.id = v.id;\n      this.form.procInstId = v.procInstId;\n      this.form.procDefId = v.procDefId;\n      this.form.priority = v.priority;\n      this.form.type = 1;\n      this.showAssign = false;\n      this.modalTaskVisible = true; // 获取可驳回节点\n\n      this.backList = [{\n        key: \"-1\",\n        name: \"发起人\"\n      }];\n      this.form.backTaskKey = \"-1\";\n      this.backLoading = true;\n      this.getAction(this.url.getBackList + v.procInstId).then(function (res) {\n        _this5.backLoading = false;\n\n        if (res.success) {\n          res.result.forEach(function (e) {\n            _this5.backList.push(e);\n          });\n        }\n      });\n    },\n    delegateTask: function delegateTask(v) {\n      this.modalTaskTitle = \"委托他人代办\";\n      this.form.id = v.id;\n      this.form.procInstId = v.procInstId;\n      this.form.type = 2;\n      this.showAssign = false;\n      this.modalTaskVisible = true;\n    },\n    history: function history(v) {\n      if (!v.procInstId) {\n        this.$message.error(\"流程实例ID不存在\");\n        return;\n      }\n\n      this.procInstId = v.procInstId;\n      this.modalLsVisible = true;\n    },\n    passAll: function passAll() {\n      var _this6 = this;\n\n      if (this.selectCount <= 0) {\n        this.$message.warning(\"您还未选择要通过的数据\");\n        return;\n      } // 批量通过\n\n\n      this.modalVisible = true;\n      this.$confirm({\n        title: \"确认通过\",\n        content: \"您确认要通过所选的 \" + this.selectCount + \" 条数据? 注意：将默认分配给节点设定的所有可审批用户\",\n        loading: true,\n        onOk: function onOk() {\n          var ids = \"\";\n\n          _this6.selectList.forEach(function (e) {\n            ids += e.id + \",\";\n          });\n\n          ids = ids.substring(0, ids.length - 1);\n\n          _this6.postFormAction(_this6.url.passAll, {\n            ids: ids\n          }).then(function (res) {\n            if (res.success) {\n              _this6.$message.success(\"操作成功\");\n\n              _this6.modalVisible = false;\n\n              _this6.clearSelectAll();\n\n              _this6.getDataList();\n            }\n          });\n        }\n      });\n    },\n    backAll: function backAll() {\n      var _this7 = this;\n\n      if (this.selectCount <= 0) {\n        this.$message.warning(\"您还未选择要驳回的数据\");\n        return;\n      } // 批量驳回\n\n\n      this.modalVisible = true;\n      this.$confirm({\n        title: \"确认驳回\",\n        content: \"您确认要驳回所选的 \" + this.selectCount + \" 条数据? 注意：所有流程将驳回至发起人\",\n        loading: true,\n        onOk: function onOk() {\n          var procInstIds = \"\";\n\n          _this7.selectList.forEach(function (e) {\n            procInstIds += e.procInstId + \",\";\n          });\n\n          procInstIds = procInstIds.substring(0, procInstIds.length - 1);\n\n          _this7.postFormAction(_this7.url.backAll, {\n            procInstIds: procInstIds\n          }).then(function (res) {\n            if (res.success) {\n              _this7.$message.success(\"操作成功\");\n\n              _this7.modalVisible = false;\n\n              _this7.clearSelectAll();\n\n              _this7.getDataList();\n            }\n          });\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["todoManage.vue"],"names":[],"mappings":"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","sourcesContent":["<style lang=\"less\">\n  @import '~@assets/less/common.less';\n</style>\n<template>\n  <div class=\"search\">\n\n    <a-card>\n      <div class=\"table-page-search-wrapper\">\n        <a-form layout=\"inline\" @keyup.enter.native=\"handleSearch\">\n          <a-row :gutter=\"24\">\n            <a-col :md=\"6\" :sm=\"8\">\n              <a-form-item label=\"任务名称\" prop=\"name\" >\n                <a-input\n                  type=\"text\" allowClear\n                  v-model=\"searchForm.name\"\n                  placeholder=\"请输入\"\n                />\n              </a-form-item>\n            </a-col>\n            <span style=\"float: left;overflow: hidden;\" class=\"table-page-search-submitButtons\">\n            <a-col :md=\"6\" :sm=\"12\" >\n                <a-button type=\"primary\"  style=\"left: 10px\" @click=\"handleSearch\" icon=\"search\">查询</a-button>\n                <a-button type=\"primary\"  @click=\"handleReset\" icon=\"reload\" style=\"margin-left: 8px;left: 10px\">重置</a-button>\n            </a-col>\n          </span>\n          </a-row>\n        </a-form>\n      </div>\n      <!--<a-row class=\"operation\">\n        <a-button @click=\"passAll\" icon=\"md-checkmark-circle-outline\">批量通过</a-button>\n        <a-button @click=\"backAll\" icon=\"md-close\">批量驳回</a-button>\n        <a-button @click=\"getDataList\" icon=\"md-refresh\">刷新</a-button>\n      </a-row>-->\n      <a-row>\n        <a-table :scroll=\"scroll\" bordered\n          :loading=\"loading\" rowKey=\"id\"\n          :dataSource=\"data\"\n          :pagination=\"ipagination\" @change=\"handleTableChange\"\n          ref=\"table\"\n        >\n          <a-table-column title=\"#\"  :width=\"50\">\n            <template slot-scope=\"t,r,i\" >\n              <span> {{i+1}} </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"任务名称\" dataIndex=\"name\"  :width=\"150\" align=\"center\">\n            <template slot-scope=\"t\">\n              <span> {{t}} </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"所属流程\" dataIndex=\"processName\"  :width=\"150\" align=\"center\">\n            <template slot-scope=\"t\">\n              <span> {{t}} </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"委托人\" dataIndex=\"owner\"  align=\"center\" :width=\"150\">\n            <template slot-scope=\"t\">\n              <span> {{t}} </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"流程发起人\" dataIndex=\"applyer\" :width=\"150\" align=\"center\">\n            <template slot-scope=\"t\">\n              <span> {{t}} </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"优先级\" dataIndex=\"priority\" :width=\"110\" align=\"center\"\n            key=\"so\" :sorter=\"(a,b)=>a.priority - b.priority\"\n          >\n            <template slot-scope=\"t\">\n              <span v-if=\"t==0\" style=\"color: green;\"> 普通 </span>\n              <span v-else-if=\"t==1\" style=\"color: orange;\"> 重要 </span>\n              <span v-else-if=\"t==2\" style=\"color: red;\"> 紧急 </span>\n              <span v-else style=\"color: #999;\"> 无 </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"状态\" dataIndex=\"isSuspended\" :width=\"100\" align=\"center\"\n                          key=\"z\" :sorter=\"(a,b)=>Boolean(a.isSuspended)?0:1 - Boolean(b.isSuspended)?0:1\"\n          >\n            <template slot-scope=\"t\">\n              <span v-if=\"!Boolean(t)\" style=\"color: green;\"> 已激活 </span>\n              <span v-if=\"Boolean(t)\" style=\"color: orange;\"> 已挂起 </span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"创建时间\" dataIndex=\"createTime\" :width=\"200\" align=\"center\">\n            <template slot-scope=\"t\">\n              <span>{{t}}</span>\n            </template>\n          </a-table-column>\n          <a-table-column title=\"操作\" dataIndex=\"\"  align=\"center\">\n            <template slot-scope=\"t,r,i\">\n              <a href=\"javascript:void(0);\" @click=\"detail(r)\" style=\"color: blue\">查看并处理</a>\n              <a-divider type=\"vertical\" />\n              <span v-if=\"Boolean(r.isSuspended)\" style=\"cursor: no-drop;color: #999999;\" title=\"流程已被挂起，无法操作！\">\n                查看并处理 <a-divider type=\"vertical\" />\n                委托他人代办 <a-divider type=\"vertical\" />\n              </span>\n              <span v-else>\n                <!--<a href=\"javascript:void(0);\" @click=\"passTask(r)\" style=\"color: green\">通过</a>\n                <a-divider type=\"vertical\" />\n                <a href=\"javascript:void(0);\" @click=\"backTask(r)\" style=\"color: orange\">驳回</a>\n                <a-divider type=\"vertical\" />-->\n                <a href=\"javascript:void(0);\" @click=\"delegateTask(r)\" style=\"color: #00A0E9\">委托他人代办</a>\n                <a-divider type=\"vertical\" />\n              </span>\n              <a href=\"javascript:void(0);\" @click=\"history(r)\" style=\"color: #217dbb\">历史</a>\n            </template>\n          </a-table-column>\n        </a-table>\n      </a-row>\n    </a-card>\n    <!---->\n    <a-modal title=\"审批历史\" v-model=\"modalLsVisible\" :mask-closable=\"false\" :width=\"'80%'\" :footer=\"null\">\n      <div v-if=\"modalLsVisible\">\n        <component :is=\"historicDetail\" :procInstId=\"procInstId\"></component>\n      </div>\n    </a-modal>\n    <!--流程表单-->\n    <a-modal :title=\"lcModa.title\" v-model=\"lcModa.visible\" :footer=\"null\" :maskClosable=\"false\" width=\"80%\">\n      <component :disabled=\"lcModa.disabled\" v-if=\"lcModa.visible\" :is=\"lcModa.formComponent\"\n                 :processData=\"lcModa.processData\" :isNew = \"lcModa.isNew\"\n                 :task=\"true\"\n                 @passTask = \"()=>passTask(lcModa.processData)\"\n                 @backTask = \"()=>backTask(lcModa.processData)\"\n                 @close=\"lcModa.visible=false,lcModa.disabled = false\"></component>\n    </a-modal>\n    <!-- 审批操作 -->\n    <a-modal :title=\"modalTaskTitle\" v-model=\"modalTaskVisible\" :mask-closable=\"false\" :width=\"500\">\n\n      <div  v-if=\"modalTaskVisible\">\n        <a-form ref=\"form\" :model=\"form\" :label-width=\"85\" :rules=\"formValidate\">\n          <a-form-item label=\"审批意见\" prop=\"reason\">\n            <a-input type=\"textarea\" v-model=\"form.comment\" :rows=\"4\" />\n          </a-form-item>\n          <a-form-item label=\"下一审批人\" prop=\"assignees\" v-show=\"showAssign\" :error=\"error\">\n            <a-select\n              v-model=\"form.assignees\"\n              placeholder=\"请选择\"\n              allowClear\n              mode=\"multiple\"\n              :loading=\"userLoading\"\n            >\n              <a-select-option v-for=\"(item, i) in assigneeList\" :key=\"i\" :value=\"item.username\">{{item.realname}}</a-select-option>\n            </a-select>\n          </a-form-item>\n          <a-form-item label=\"下一审批人\" v-show=\"isGateway\">\n            <span>分支网关处暂不支持自定义选择下一审批人，将发送给下一节点所有人</span>\n          </a-form-item>\n          <div v-show=\"form.type==1\">\n            <a-form-item label=\"驳回至\">\n              <a-select\n                v-model=\"form.backTaskKey\"\n                :loading=\"backLoading\"\n                @change=\"changeBackTask\"\n              >\n                <a-select-option v-for=\"(item, i) in backList\" :key=\"i\" :value=\"item.key\">{{item.name}}</a-select-option>\n              </a-select>\n            </a-form-item>\n            <a-form-item label=\"指定原节点审批人\" prop=\"assignees\" v-show=\"form.backTaskKey!=-1\" :error=\"error\">\n              <a-select\n                v-model=\"form.assignees\"\n                placeholder=\"请选择\"\n                allowClear\n                mode=\"multiple\"\n                :loading=\"userLoading\"\n              >\n                <a-select-option v-for=\"(item, i) in assigneeList\" :key=\"i\" :value=\"item.username\">{{item.realname}}</a-select-option>\n              </a-select>\n            </a-form-item>\n          </div>\n          <a-form-item label=\"选择委托人\" prop=\"userId\" :error=\"error\" v-show=\"form.type==2\">\n            <JSelectUserByDep v-model=\"form.userId\" :multi=\"false\"></JSelectUserByDep>\n          </a-form-item>\n          <a-form-item label=\"消息通知\">\n            <a-checkbox v-model=\"form.sendMessage\">站内消息通知</a-checkbox>\n            <a-checkbox v-model=\"form.sendSms\" disabled>短信通知</a-checkbox>\n            <a-checkbox v-model=\"form.sendEmail\" disabled>邮件通知</a-checkbox>\n          </a-form-item>\n        </a-form>\n      </div>\n      <div slot=\"footer\">\n        <a-button type=\"text\" @click=\"modalTaskVisible=false\">取消</a-button>\n        <a-button type=\"primary\" :loading=\"submitLoading\" @click=\"handelSubmit\">提交</a-button>\n      </div>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin'\nimport { activitiMixin } from '@/views/activiti/mixins/activitiMixin'\nimport JSelectUserByDep from '@/components/jeecgbiz/JSelectUserByDep'\nexport default {\n  name: \"todo-manage\",\n  mixins:[activitiMixin,JeecgListMixin],\n  components:{JSelectUserByDep},\n  data() {\n    return {\n      openSearch: true,\n      openTip: true,\n      loading: true, // 表单加载状态\n      modalTaskVisible: false,\n      userLoading: false,\n      backLoading: false,\n      selectCount: 0, // 多选计数\n      selectList: [], // 多选数据\n      assigneeList: [],\n      backList: [\n        {\n          key: \"-1\",\n          name: \"发起人\"\n        }\n      ],\n      error: \"\",\n      showAssign: false,\n      searchForm: {\n        // 搜索框对应data对象\n        name: \"\",\n      },\n      modalTaskTitle: \"\",\n      modalTitle: \"\", // 添加或编辑标题\n      form: {\n        id: \"\",\n        userId: \"\",\n        procInstId: \"\",\n        comment: \"\",\n        type: 0,\n        assignees: [],\n        backTaskKey: \"-1\",\n        sendMessage: true,\n        sendSms: false,\n        sendEmail: false\n      },\n      formValidate: {\n        // 表单验证规则\n      },\n      submitLoading: false, // 添加或编辑提交状态\n      data: [], // 表单数据\n      total: 0, // 表单数据总数\n      dictPriority: [],\n      isGateway: false,\n      lcModa: {\n        title:'',\n        disabled:false,\n        visible:false,\n        formComponent : null,\n        isNew : false\n      },\n      url:{\n        todoList:'/actTask/todoList',\n        pass:'/actTask/pass',\n        back:'/actTask/back',\n        backToTask:'/actTask/backToTask',\n        delegate:'/actTask/delegate',\n        getNextNode:'/activiti_process/getNextNode',\n        getNode:'/activiti_process/getNode/',\n        getBackList:'/actTask/getBackList/',\n        passAll:'/actTask/passAll/',\n        backAll:'/actTask/backAll/',\n      },\n      /*历史*/\n      modalLsVisible: false,\n      procInstId:''\n    };\n  },\n  mounted() {\n    this.init();\n  },\n  methods: {\n    init() {\n      this.getDataList();\n    },\n    loadData(){},\n    getDataList() {\n      this.loading = true;\n      this.getAction(this.url.todoList,this.searchForm).then(res => {\n        this.loading = false;\n        if (res.success) {\n          this.data = res.result||[];\n          this.total = this.data.leading;\n        }\n      });\n    },\n    handleTableChange(pagination, filters, sorter) {\n      //分页、排序、筛选变化时触发\n      if (Object.keys(sorter).length > 0) {\n        this.isorter.column = sorter.field;\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\"\n      }\n      this.ipagination = pagination;\n      // this.loadData();\n    },\n    handleSearch() {\n      this.getDataList();\n    },\n    handleReset() {\n      this.searchForm={};\n      // 重新加载数据\n      this.getDataList();\n    },\n    showSelect(e) {\n      this.selectList = e;\n      this.selectCount = e.length;\n    },\n    clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    /*审批提交的方法*/\n    handelSubmit() {\n      console.log(\"提交\")\n      this.submitLoading = true;\n      var formData = Object.assign({},this.form);\n      formData.assignees = formData.assignees.join(\",\");\n      if (formData.type == 0) {\n        // 通过\n        if (this.showAssign && formData.assignees.length < 1) {\n          this.$message.error(\"请至少选择一个审批人\")\n          this.submitLoading = false;\n          return;\n        } else {\n          this.error = \"\";\n        }\n        this.postFormAction(this.url.pass,formData).then(res => {\n          this.submitLoading = false;\n          if (res.success) {\n            this.lcModa.visible=false\n            this.$message.success(\"操作成功\");\n            this.modalTaskVisible = false;\n            this.getDataList();\n          }\n        });\n      } else if (formData.type == 1) {\n        // 驳回\n        if (formData.backTaskKey == \"-1\") {\n          // 驳回至发起人\n          this.postFormAction(this.url.back,formData).then(res => {\n            this.submitLoading = false;\n            if (res.success) {\n              this.lcModa.visible=false\n              this.$message.success(\"操作成功\");\n              this.modalTaskVisible = false;\n              this.getDataList();\n            }\n          });\n        } else {\n          // 自定义驳回\n          if (formData.backTaskKey != \"-1\" && formData.assignees.length < 1) {\n            this.$message.error(\"请至少选择一个审批人\")\n            this.submitLoading = false;\n            return;\n          } else {\n            this.error = \"\";\n          }\n          this.postFormAction(this.url.backToTask,formData).then(res => {\n            this.submitLoading = false;\n            if (res.success) {\n              this.lcModa.visible=false\n              this.$message.success(\"操作成功\");\n              this.modalTaskVisible = false;\n              this.getDataList();\n            }\n          });\n        }\n      } else if (formData.type == 2) {\n        // 委托\n        if (!formData.userId) {\n          this.$message.error(\"请选择一委托人\")\n          this.submitLoading = false;\n          return;\n        } else {\n          this.error = \"\";\n        }\n        this.postFormAction(this.url.delegate,formData).then(res => {\n          this.submitLoading = false;\n          if (res.success) {\n            this.$message.success(\"操作成功\");\n            this.modalTaskVisible = false;\n            this.getDataList();\n          }\n        });\n      }\n    },\n    detail(r) {\n      if (!r.routeName) {\n        this.$message.warning(\n          \"该流程信息未配置表单，请联系开发人员！\"\n        );\n        return;\n      }\n      this.lcModa.disabled = true;\n      this.lcModa.title = '查看流程业务信息：'+r.processName;\n      this.lcModa.formComponent = this.getFormComponent(r.routeName).component;\n      this.lcModa.processData = r;\n      this.lcModa.isNew = false;\n      this.lcModa.visible = true;\n    },\n    passTask(v) {\n      this.modalTaskTitle = \"审批通过\";\n      this.form.id = v.id;\n      this.form.procInstId = v.procInstId;\n      this.form.priority = v.priority;\n      this.form.type = 0;\n      this.modalTaskVisible = true;\n      this.userLoading = true;\n      this.getAction(this.url.getNextNode,{procDefId:v.procDefId, currActId:v.key}).then(res => {\n        this.userLoading = false;\n        if (res.success) {\n          if (res.result.type == 4) {\n            this.isGateway = true;\n            this.showAssign = false;\n            this.error = \"\";\n            return;\n          }\n          this.isGateway = false;\n          if (res.result.users && res.result.users.length > 0) {\n            this.error = \"\";\n            this.assigneeList = res.result.users;\n            console.log(this.assigneeList)\n            // 默认勾选\n            let ids = [];\n            res.result.users.forEach(e => {\n              ids.push(e.username);\n            });\n            this.form.assignees = ids;\n            this.showAssign = true;\n          } else {\n            this.form.assignees = [];\n            this.showAssign = false;\n          }\n        }\n      });\n    },\n    changeBackTask(v) {\n      if (v == \"-1\") {\n        return;\n      }\n      this.userLoading = true;\n      this.getAction(this.url.getNode+v).then(res => {\n        this.userLoading = false;\n        if (res.success) {\n          if (res.result.users && res.result.users.length > 0) {\n            this.assigneeList = res.result.users;\n            // 默认勾选\n            let ids = [];\n            res.result.users.forEach(e => {\n              ids.push(e.username);\n            });\n            this.form.assignees = ids;\n          }\n        }\n      });\n    },\n    backTask(v) {\n      this.modalTaskTitle = \"审批驳回\";\n      this.form.id = v.id;\n      this.form.procInstId = v.procInstId;\n      this.form.procDefId = v.procDefId;\n      this.form.priority = v.priority;\n      this.form.type = 1;\n      this.showAssign = false;\n      this.modalTaskVisible = true;\n      // 获取可驳回节点\n      this.backList = [\n        {\n          key: \"-1\",\n          name: \"发起人\"\n        }\n      ];\n      this.form.backTaskKey = \"-1\";\n      this.backLoading = true;\n      this.getAction(this.url.getBackList+v.procInstId).then(res => {\n        this.backLoading = false;\n        if (res.success) {\n          res.result.forEach(e => {\n            this.backList.push(e);\n          });\n        }\n      });\n    },\n    delegateTask(v) {\n      this.modalTaskTitle = \"委托他人代办\";\n      this.form.id = v.id;\n      this.form.procInstId = v.procInstId;\n      this.form.type = 2;\n      this.showAssign = false;\n      this.modalTaskVisible = true;\n    },\n    history(v) {\n      if (!v.procInstId) {\n        this.$message.error(\"流程实例ID不存在\");\n        return;\n      }\n      this.procInstId = v.procInstId;\n      this.modalLsVisible = true;\n    },\n    passAll() {\n      if (this.selectCount <= 0) {\n        this.$message.warning(\"您还未选择要通过的数据\");\n        return;\n      }\n      // 批量通过\n      this.modalVisible = true;\n      this.$confirm({\n        title: \"确认通过\",\n        content:\n          \"您确认要通过所选的 \" +\n          this.selectCount +\n          \" 条数据? 注意：将默认分配给节点设定的所有可审批用户\",\n        loading: true,\n        onOk: () => {\n          let ids = \"\";\n          this.selectList.forEach(function(e) {\n            ids += e.id + \",\";\n          });\n          ids = ids.substring(0, ids.length - 1);\n          this.postFormAction(this.url.passAll,{ids:ids}).then(res => {\n            if (res.success) {\n              this.$message.success(\"操作成功\");\n              this.modalVisible = false;\n              this.clearSelectAll();\n              this.getDataList();\n            }\n          });\n        }\n      });\n    },\n    backAll() {\n      if (this.selectCount <= 0) {\n        this.$message.warning(\"您还未选择要驳回的数据\");\n        return;\n      }\n      // 批量驳回\n      this.modalVisible = true;\n      this.$confirm({\n        title: \"确认驳回\",\n        content:\n          \"您确认要驳回所选的 \" +\n          this.selectCount +\n          \" 条数据? 注意：所有流程将驳回至发起人\",\n        loading: true,\n        onOk: () => {\n          let procInstIds = \"\";\n          this.selectList.forEach(function(e) {\n            procInstIds += e.procInstId + \",\";\n          });\n          procInstIds = procInstIds.substring(0, procInstIds.length - 1);\n          this.postFormAction(this.url.backAll,{procInstIds:procInstIds}).then(res => {\n            if (res.success) {\n              this.$message.success(\"操作成功\");\n              this.modalVisible = false;\n              this.clearSelectAll();\n              this.getDataList();\n            }\n          });\n        }\n      });\n    }\n  },\n\n};\n</script>"],"sourceRoot":"src/views/activiti"}]}