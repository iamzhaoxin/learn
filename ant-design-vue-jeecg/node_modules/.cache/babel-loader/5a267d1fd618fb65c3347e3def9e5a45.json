{"remainingRequest":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\cas\\sso.js","dependencies":[{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\cas\\sso.js","mtime":1611914356000},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1617935819779}],"contextDependencies":[],"result":["import Vue from 'vue';\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\";\nimport store from '@/store';\n/**\n * 单点登录\n */\n\nvar init = function init(callback) {\n  if (process.env.VUE_APP_SSO == 'true') {\n    console.log(\"-------单点登录开始-------\");\n    var token = Vue.ls.get(ACCESS_TOKEN);\n    var st = getUrlParam(\"ticket\");\n    var sevice = \"http://\" + window.location.host + \"/\";\n\n    if (token) {\n      loginSuccess(callback);\n    } else {\n      if (st) {\n        validateSt(st, sevice, callback);\n      } else {\n        var serviceUrl = encodeURIComponent(sevice);\n        window.location.href = window._CONFIG['casPrefixUrl'] + \"/login?service=\" + serviceUrl;\n      }\n    }\n\n    console.log(\"-------单点登录结束-------\");\n  } else {\n    callback && callback();\n  }\n};\n\nvar SSO = {\n  init: init\n};\n\nfunction getUrlParam(paraName) {\n  var url = document.location.toString();\n  var arrObj = url.split(\"?\");\n\n  if (arrObj.length > 1) {\n    var arrPara = arrObj[1].split(\"&\");\n    var arr;\n\n    for (var i = 0; i < arrPara.length; i++) {\n      arr = arrPara[i].split(\"=\");\n\n      if (arr != null && arr[0] == paraName) {\n        return arr[1];\n      }\n    }\n\n    return \"\";\n  } else {\n    return \"\";\n  }\n}\n\nfunction validateSt(ticket, service, callback) {\n  var params = {\n    ticket: ticket,\n    service: service\n  };\n  store.dispatch('ValidateLogin', params).then(function (res) {\n    //this.departConfirm(res)\n    if (res.success) {\n      loginSuccess(callback);\n    } else {\n      var sevice = \"http://\" + window.location.host + \"/\";\n      var serviceUrl = encodeURIComponent(sevice);\n      window.location.href = window._CONFIG['casPrefixUrl'] + \"/login?service=\" + serviceUrl;\n    }\n  }).catch(function (err) {\n    console.log(err); //that.requestFailed(err);\n  });\n}\n\nfunction loginSuccess(callback) {\n  callback();\n}\n\nexport default SSO;",{"version":3,"sources":["D:/activiti/project01/jeecg-boot-activiti-master/ant-design-vue-jeecg/src/cas/sso.js"],"names":["Vue","ACCESS_TOKEN","store","init","callback","process","env","VUE_APP_SSO","console","log","token","ls","get","st","getUrlParam","sevice","window","location","host","loginSuccess","validateSt","serviceUrl","encodeURIComponent","href","_CONFIG","SSO","paraName","url","document","toString","arrObj","split","length","arrPara","arr","i","ticket","service","params","dispatch","then","res","success","catch","err"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\"\nimport store from '@/store'\n/**\n * 单点登录\n */\nconst init = (callback) => {\n  if (process.env.VUE_APP_SSO == 'true') {\n    console.log(\"-------单点登录开始-------\");\n    let token = Vue.ls.get(ACCESS_TOKEN);\n    let st = getUrlParam(\"ticket\");\n    let sevice = \"http://\" + window.location.host + \"/\";\n    if (token) {\n      loginSuccess(callback);\n    } else {\n      if (st) {\n        validateSt(st, sevice, callback);\n      } else {\n        let serviceUrl = encodeURIComponent(sevice);\n        window.location.href = window._CONFIG['casPrefixUrl'] + \"/login?service=\" + serviceUrl;\n      }\n    }\n    console.log(\"-------单点登录结束-------\");\n  }else{\n    callback && callback()\n  }\n};\nconst SSO = {\n  init: init\n};\n\nfunction getUrlParam(paraName) {\n  let url = document.location.toString();\n  let arrObj = url.split(\"?\");\n\n  if (arrObj.length > 1) {\n    let arrPara = arrObj[1].split(\"&\");\n    let arr;\n\n    for (let i = 0; i < arrPara.length; i++) {\n      arr = arrPara[i].split(\"=\");\n\n      if (arr != null && arr[0] == paraName) {\n        return arr[1];\n      }\n    }\n    return \"\";\n  }\n  else {\n    return \"\";\n  }\n}\n\nfunction validateSt(ticket,service,callback){\n  let params = {\n    ticket: ticket,\n    service:service\n  };\n  store.dispatch('ValidateLogin',params).then(res => {\n    //this.departConfirm(res)\n    if(res.success){\n      loginSuccess(callback);\n    }else{\n      let sevice = \"http://\"+window.location.host+\"/\";\n      let serviceUrl = encodeURIComponent(sevice);\n      window.location.href = window._CONFIG['casPrefixUrl']+\"/login?service=\"+serviceUrl;\n    }\n  }).catch((err) => {\n    console.log(err);\n    //that.requestFailed(err);\n  });\n}\n\nfunction loginSuccess (callback) {\n  callback();\n}\nexport default SSO;"]}]}