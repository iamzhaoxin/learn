{"remainingRequest":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\activiti\\applyList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\activiti\\applyList.vue","mtime":1621944249251},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1621061372054},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1621061372054}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin';\nimport { activitiMixin } from '@/views/activiti/mixins/activitiMixin';\nimport { filterObj } from '@/utils/util';\nimport JEllipsis from '@/components/jeecg/JEllipsis';\nimport { deleteAction, getAction, downFile } from '@/api/manage';\nimport pick from \"lodash.pick\";\nimport JTreeSelect from '@/components/jeecg/JTreeSelect';\nimport { initDictOptions, filterDictText } from '@/components/dict/JDictSelectUtil';\nimport historicDetail from '@/views/activiti/historicDetail';\nexport default {\n  name: \"applyList\",\n  mixins: [activitiMixin, JeecgListMixin],\n  components: {\n    JEllipsis: JEllipsis,\n    JTreeSelect: JTreeSelect,\n    historicDetail: historicDetail\n  },\n  data: function data() {\n    return {\n      description: '我的申请',\n      dictOptions: [],\n      url: {\n        list: \"/actBusiness/listData\",\n        getProcessDataList: \"/activiti_process/listData\",\n        delByIds: '/actBusiness/delByIds',\n        getFirstNode: '/actProcessIns/getFirstNode',\n        applyBusiness: '/actBusiness/apply',\n        cancelApply: '/actBusiness/cancel'\n      },\n      // 查询条件\n      queryParam: {\n        createTimeRange: [],\n        keyWord: ''\n      },\n      // 表头\n      labelCol: {\n        xs: {\n          span: 4\n        },\n        sm: {\n          span: 4\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 20\n        },\n        sm: {\n          span: 20\n        }\n      },\n      processModalVisible: null,\n      activeKeyAll: [],\n      activeKey: [],\n      processDataMap: {},\n      searchProcessKey: null,\n      addApplyLoading: false,\n      lcModa: {\n        title: '',\n        disabled: false,\n        visible: false,\n        formComponent: null,\n        isNew: false\n      },\n      form: {\n        priority: 0,\n        assignees: [],\n        sendMessage: true\n      },\n      modalVisible: false,\n      showAssign: false,\n      assigneeList: [],\n      isGateway: false,\n      dictPriority: [],\n      submitLoading: false,\n      error: \"\",\n\n      /*审批历史*/\n      modalLsVisible: false,\n      procInstId: '',\n      modalCancelVisible: false,\n      cancelForm: {}\n    };\n  },\n  computed: {},\n  methods: {\n    initDictConfig: function initDictConfig() {\n      var _this = this;\n\n      //初始化字典 - 流程分类\n      initDictOptions('bpm_process_type').then(function (res) {\n        if (res.success) {\n          _this.dictOptions = res.result;\n        }\n      });\n    },\n    filterDictText: function filterDictText(dictOptions, text) {\n      if (dictOptions instanceof Array) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = dictOptions[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var dictItem = _step.value;\n\n            if (text === dictItem.value) {\n              return dictItem.text;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      }\n\n      return text || text == 'null' ? '' : text;\n    },\n    getProcessList: function getProcessList() {\n      var _this2 = this;\n\n      this.addApplyLoading = true;\n      this.getAction(this.url.getProcessDataList, {\n        status: 1,\n        roles: true\n      }).then(function (res) {\n        _this2.activeKeyAll = [];\n\n        if (res.success) {\n          var result = res.result || [];\n\n          if (result.length > 0) {\n            var searchProcessKey = _this2.searchProcessKey;\n\n            if (searchProcessKey) {\n              //过滤条件\n              result = _.filter(result, function (o) {\n                return o.name.indexOf(searchProcessKey) > -1;\n              });\n            }\n\n            _this2.processDataMap = _.groupBy(result, 'categoryId');\n\n            for (var categoryId in _this2.processDataMap) {\n              _this2.activeKeyAll.push(categoryId);\n            }\n\n            _this2.activeKey = _this2.activeKeyAll;\n          }\n\n          _this2.processModalVisible = true;\n        } else {\n          _this2.$message.warning(res.message);\n        }\n      }).finally(function () {\n        return _this2.addApplyLoading = false;\n      });\n    },\n    loadData: function loadData(arg) {\n      var _this3 = this;\n\n      console.log(\"loadData\");\n\n      if (!this.url.list) {\n        this.$message.error(\"请设置url.list属性!\");\n        return;\n      } //加载数据 若传入参数1则加载第一页的内容\n\n\n      if (arg === 1) {\n        this.ipagination.current = 1;\n      }\n\n      var params = this.getQueryParams(); //查询条件\n\n      this.loading = true;\n      getAction(this.url.list, params).then(function (res) {\n        if (res.success) {\n          var records = res.result || [];\n          _this3.dataSource = records;\n          _this3.ipagination.total = records.length;\n        }\n\n        if (res.code === 510) {\n          _this3.$message.warning(res.message);\n        }\n\n        _this3.loading = false;\n      });\n    },\n    getQueryParams: function getQueryParams() {\n      var param = Object.assign({}, this.queryParam, this.isorter);\n      delete param.createTimeRange; // 时间参数不传递后台\n\n      return filterObj(param);\n    },\n    // 重置\n    searchReset: function searchReset() {\n      var that = this;\n      var logType = that.queryParam.logType;\n      that.queryParam = {}; //清空查询区域参数\n\n      that.queryParam.logType = logType;\n      that.loadData(this.ipagination.current);\n    },\n    onDateChange: function onDateChange(value, dateString) {\n      console.log(dateString[0], dateString[1]);\n      this.queryParam.createTime_begin = dateString[0];\n      this.queryParam.createTime_end = dateString[1];\n    },\n    onDateOk: function onDateOk(value) {\n      console.log(value);\n    },\n    getStatus: function getStatus(status) {\n      var text = \"未知\",\n          color = \"\";\n\n      if (status == 0) {\n        text = \"草稿\";\n        color = \"default\";\n      } else if (status == 1) {\n        text = \"处理中\";\n        color = \"orange\";\n      } else if (status == 2) {\n        text = \"已结束\";\n        color = \"blue\";\n      } else if (status == 3) {\n        text = \"已撤回\";\n        color = \"magenta\";\n      }\n\n      return {\n        text: text,\n        color: color\n      };\n    },\n    getResult: function getResult(result) {\n      var text = \"未知\",\n          color = \"\";\n\n      if (result == 0) {\n        text = \"未提交\";\n        color = \"default\";\n      } else if (result == 1) {\n        text = \"处理中\";\n        color = \"orange\";\n      } else if (result == 2) {\n        text = \"已通过\";\n        color = \"green\";\n      } else if (result == 3) {\n        text = \"已驳回\";\n        color = \"red\";\n      }\n\n      return {\n        text: text,\n        color: color\n      };\n    },\n    apply: function apply(v) {\n      var _this4 = this;\n\n      if (!v.procDefId || v.procDefId == \"null\") {\n        this.$message.error(\"流程定义为空\");\n        return;\n      }\n\n      this.form.id = v.id;\n      this.form.procDefId = v.procDefId;\n      this.form.title = v.title; // 加载审批人\n\n      this.getAction(this.url.getFirstNode, {\n        procDefId: v.procDefId,\n        tableId: v.tableId,\n        tableName: v.tableName\n      }).then(function (res) {\n        if (res.success) {\n          if (res.result.type == 3 || res.result.type == 4) {\n            _this4.isGateway = true;\n            _this4.modalVisible = true;\n            _this4.form.firstGateway = true;\n            _this4.showAssign = false;\n            _this4.error = \"\";\n            return;\n          }\n\n          _this4.form.firstGateway = false;\n          _this4.isGateway = false;\n\n          if (res.result.users && res.result.users.length > 0) {\n            _this4.error = \"\";\n            _this4.assigneeList = res.result.users; // 默认勾选\n\n            var ids = [];\n            res.result.users.forEach(function (e) {\n              ids.push(e.username);\n            });\n            _this4.form.assignees = ids;\n            _this4.showAssign = true;\n          } else {\n            _this4.form.assignees = [];\n            _this4.showAssign = true;\n            _this4.error = '审批节点未分配候选审批人员，请联系管理员！';\n          }\n\n          if (_this4.error) {\n            _this4.$message.error(_this4.error);\n\n            return;\n          }\n\n          _this4.modalVisible = true;\n        } else {\n          _this4.$message.error(res.message);\n        }\n      });\n    },\n    applySubmit: function applySubmit() {\n      var _this5 = this;\n\n      if (this.showAssign && this.form.assignees.length < 1) {\n        this.error = \"请至少选择一个审批人\";\n        this.$message.error(this.error);\n        return;\n      } else {\n        this.error = \"\";\n      }\n\n      this.submitLoading = true;\n      var params = Object.assign({}, this.form);\n      params.assignees = params.assignees.join(\",\");\n      this.postFormAction(this.url.applyBusiness, params).then(function (res) {\n        if (res.success) {\n          _this5.$message.success(\"操作成功\");\n\n          _this5.loadData();\n\n          _this5.modalVisible = false;\n        } else {\n          _this5.$message.error(res.message);\n        }\n      }).finally(function () {\n        return _this5.submitLoading = false;\n      });\n    },\n    edit: function edit(r, isView) {\n      if (!r.routeName) {\n        this.$message.warning(\"该流程信息未配置表单，请联系开发人员！\");\n        return;\n      }\n\n      isView = isView || false;\n      this.lcModa.disabled = isView;\n      this.lcModa.title = '修改流程业务信息：' + r.title;\n      if (isView) this.lcModa.title = '查看流程业务信息：' + r.title;\n      this.lcModa.formComponent = this.getFormComponent(r.routeName).component;\n      this.lcModa.processData = r;\n      this.lcModa.isNew = false;\n      this.lcModa.visible = true;\n    },\n    remove: function remove(r) {\n      var _this6 = this;\n\n      this.postFormAction(this.url.delByIds, {\n        ids: r.id\n      }).then(function (res) {\n        if (res.success) {\n          _this6.$message.success(res.message);\n\n          _this6.loadData();\n        } else {\n          _this6.$message.error(res.message);\n        }\n      });\n    },\n    cancel: function cancel(v) {\n      this.cancelForm.id = v.id;\n      this.cancelForm.procInstId = v.procInstId;\n      this.modalCancelVisible = true;\n    },\n    handelSubmitCancel: function handelSubmitCancel() {\n      var _this7 = this;\n\n      this.submitLoading = true;\n      this.postFormAction(this.url.cancelApply, this.cancelForm).then(function (res) {\n        if (res.success) {\n          _this7.$message.success(\"操作成功\");\n\n          _this7.loadData();\n\n          _this7.modalCancelVisible = false;\n        } else {\n          _this7.$message.error(res.message);\n        }\n      }).finally(function () {\n        return _this7.submitLoading = false;\n      });\n    },\n    history: function history(v) {\n      if (!v.procInstId) {\n        this.$message.error(\"流程实例ID不存在\");\n        return;\n      }\n\n      this.procInstId = v.procInstId;\n      this.modalLsVisible = true;\n    },\n    detail: function detail(v) {\n      this.edit(v, true);\n    },\n    handleTableChange: function handleTableChange(pagination, filters, sorter) {\n      //分页、排序、筛选变化时触发\n      //TODO 筛选\n      if (Object.keys(sorter).length > 0) {\n        this.isorter.column = sorter.field;\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\";\n      }\n\n      this.ipagination = pagination; // this.loadData();\n    },\n    addApply: function addApply() {\n      this.getProcessList();\n    },\n    onSearchProcess: function onSearchProcess(value) {\n      this.searchProcessKey = value;\n      this.getProcessList();\n    },\n    chooseProcess: function chooseProcess(v) {\n      if (!v.routeName) {\n        this.$message.warning(\"该流程信息未配置表单，请联系开发人员！\");\n        return;\n      }\n\n      this.lcModa.formComponent = this.getFormComponent(v.routeName).component;\n      this.lcModa.title = '发起流程：' + v.name;\n      this.lcModa.isNew = true;\n      this.lcModa.processData = v;\n      this.lcModa.visible = true;\n      console.log(\"发起\", v);\n    },\n    afterSub: function afterSub(formData) {\n      this.lcModa.visible = false;\n      this.loadData();\n    }\n  }\n};",{"version":3,"sources":["applyList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8PA,SAAA,cAAA,QAAA,yBAAA;AACA,SAAA,aAAA,QAAA,uCAAA;AACA,SAAA,SAAA,QAAA,cAAA;AACA,OAAA,SAAA,MAAA,8BAAA;AACA,SAAA,YAAA,EAAA,SAAA,EAAA,QAAA,QAAA,cAAA;AACA,OAAA,IAAA,MAAA,aAAA;AACA,OAAA,WAAA,MAAA,gCAAA;AACA,SAAA,eAAA,EAAA,cAAA,QAAA,mCAAA;AACA,OAAA,cAAA,MAAA,iCAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,MAAA,EAAA,CAAA,aAAA,EAAA,cAAA,CAFA;AAGA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA,SADA;AAEA,IAAA,WAAA,EAAA,WAFA;AAGA,IAAA,cAAA,EAAA;AAHA,GAHA;AAQA,EAAA,IARA,kBAQA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,MADA;AAEA,MAAA,WAAA,EAAA,EAFA;AAGA,MAAA,GAAA,EAAA;AACA,QAAA,IAAA,EAAA,uBADA;AAEA,QAAA,kBAAA,EAAA,4BAFA;AAGA,QAAA,QAAA,EAAA,uBAHA;AAIA,QAAA,YAAA,EAAA,6BAJA;AAKA,QAAA,aAAA,EAAA,oBALA;AAMA,QAAA,WAAA,EAAA;AANA,OAHA;AAWA;AACA,MAAA,UAAA,EAAA;AACA,QAAA,eAAA,EAAA,EADA;AAEA,QAAA,OAAA,EAAA;AAFA,OAZA;AAgBA;AACA,MAAA,QAAA,EAAA;AACA,QAAA,EAAA,EAAA;AAAA,UAAA,IAAA,EAAA;AAAA,SADA;AAEA,QAAA,EAAA,EAAA;AAAA,UAAA,IAAA,EAAA;AAAA;AAFA,OAjBA;AAqBA,MAAA,UAAA,EAAA;AACA,QAAA,EAAA,EAAA;AAAA,UAAA,IAAA,EAAA;AAAA,SADA;AAEA,QAAA,EAAA,EAAA;AAAA,UAAA,IAAA,EAAA;AAAA;AAFA,OArBA;AAyBA,MAAA,mBAAA,EAAA,IAzBA;AA0BA,MAAA,YAAA,EAAA,EA1BA;AA2BA,MAAA,SAAA,EAAA,EA3BA;AA4BA,MAAA,cAAA,EAAA,EA5BA;AA6BA,MAAA,gBAAA,EAAA,IA7BA;AA8BA,MAAA,eAAA,EAAA,KA9BA;AA+BA,MAAA,MAAA,EAAA;AACA,QAAA,KAAA,EAAA,EADA;AAEA,QAAA,QAAA,EAAA,KAFA;AAGA,QAAA,OAAA,EAAA,KAHA;AAIA,QAAA,aAAA,EAAA,IAJA;AAKA,QAAA,KAAA,EAAA;AALA,OA/BA;AAsCA,MAAA,IAAA,EAAA;AACA,QAAA,QAAA,EAAA,CADA;AAEA,QAAA,SAAA,EAAA,EAFA;AAGA,QAAA,WAAA,EAAA;AAHA,OAtCA;AA2CA,MAAA,YAAA,EAAA,KA3CA;AA4CA,MAAA,UAAA,EAAA,KA5CA;AA6CA,MAAA,YAAA,EAAA,EA7CA;AA8CA,MAAA,SAAA,EAAA,KA9CA;AA+CA,MAAA,YAAA,EAAA,EA/CA;AAgDA,MAAA,aAAA,EAAA,KAhDA;AAiDA,MAAA,KAAA,EAAA,EAjDA;;AAkDA;AACA,MAAA,cAAA,EAAA,KAnDA;AAoDA,MAAA,UAAA,EAAA,EApDA;AAqDA,MAAA,kBAAA,EAAA,KArDA;AAsDA,MAAA,UAAA,EAAA;AAtDA,KAAA;AAwDA,GAjEA;AAkEA,EAAA,QAAA,EAAA,EAlEA;AAoEA,EAAA,OAAA,EAAA;AAEA,IAAA,cAFA,4BAEA;AAAA;;AACA;AACA,MAAA,eAAA,CAAA,kBAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,UAAA,KAAA,CAAA,WAAA,GAAA,GAAA,CAAA,MAAA;AACA;AACA,OAJA;AAKA,KATA;AAUA,IAAA,cAVA,0BAUA,WAVA,EAUA,IAVA,EAUA;AACA,UAAA,WAAA,YAAA,KAAA,EAAA;AAAA;AAAA;AAAA;;AAAA;AACA,+BAAA,WAAA,8HAAA;AAAA,gBAAA,QAAA;;AACA,gBAAA,IAAA,KAAA,QAAA,CAAA,KAAA,EAAA;AACA,qBAAA,QAAA,CAAA,IAAA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;AACA,aAAA,IAAA,IAAA,IAAA,IAAA,MAAA,GAAA,EAAA,GAAA,IAAA;AACA,KAnBA;AAoBA,IAAA,cApBA,4BAoBA;AAAA;;AACA,WAAA,eAAA,GAAA,IAAA;AACA,WAAA,SAAA,CAAA,KAAA,GAAA,CAAA,kBAAA,EAAA;AAAA,QAAA,MAAA,EAAA,CAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,YAAA,GAAA,EAAA;;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,cAAA,MAAA,GAAA,GAAA,CAAA,MAAA,IAAA,EAAA;;AACA,cAAA,MAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,gBAAA,gBAAA,GAAA,MAAA,CAAA,gBAAA;;AACA,gBAAA,gBAAA,EAAA;AAAA;AACA,cAAA,MAAA,GAAA,CAAA,CAAA,MAAA,CAAA,MAAA,EAAA,UAAA,CAAA,EAAA;AAAA,uBAAA,CAAA,CAAA,IAAA,CAAA,OAAA,CAAA,gBAAA,IAAA,CAAA,CAAA;AAAA,eAAA,CAAA;AACA;;AACA,YAAA,MAAA,CAAA,cAAA,GAAA,CAAA,CAAA,OAAA,CAAA,MAAA,EAAA,YAAA,CAAA;;AACA,iBAAA,IAAA,UAAA,IAAA,MAAA,CAAA,cAAA,EAAA;AACA,cAAA,MAAA,CAAA,YAAA,CAAA,IAAA,CAAA,UAAA;AACA;;AACA,YAAA,MAAA,CAAA,SAAA,GAAA,MAAA,CAAA,YAAA;AACA;;AACA,UAAA,MAAA,CAAA,mBAAA,GAAA,IAAA;AACA,SAdA,MAcA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,OAnBA,EAmBA,OAnBA,CAmBA;AAAA,eAAA,MAAA,CAAA,eAAA,GAAA,KAAA;AAAA,OAnBA;AAoBA,KA1CA;AA2CA,IAAA,QA3CA,oBA2CA,GA3CA,EA2CA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,UAAA;;AACA,UAAA,CAAA,KAAA,GAAA,CAAA,IAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,gBAAA;AACA;AACA,OALA,CAMA;;;AACA,UAAA,GAAA,KAAA,CAAA,EAAA;AACA,aAAA,WAAA,CAAA,OAAA,GAAA,CAAA;AACA;;AACA,UAAA,MAAA,GAAA,KAAA,cAAA,EAAA,CAVA,CAUA;;AACA,WAAA,OAAA,GAAA,IAAA;AACA,MAAA,SAAA,CAAA,KAAA,GAAA,CAAA,IAAA,EAAA,MAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,cAAA,OAAA,GAAA,GAAA,CAAA,MAAA,IAAA,EAAA;AACA,UAAA,MAAA,CAAA,UAAA,GAAA,OAAA;AACA,UAAA,MAAA,CAAA,WAAA,CAAA,KAAA,GAAA,OAAA,CAAA,MAAA;AACA;;AACA,YAAA,GAAA,CAAA,IAAA,KAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,GAAA,CAAA,OAAA;AACA;;AACA,QAAA,MAAA,CAAA,OAAA,GAAA,KAAA;AACA,OAVA;AAWA,KAlEA;AAmEA,IAAA,cAnEA,4BAmEA;AACA,UAAA,KAAA,GAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,KAAA,UAAA,EAAA,KAAA,OAAA,CAAA;AACA,aAAA,KAAA,CAAA,eAAA,CAFA,CAEA;;AACA,aAAA,SAAA,CAAA,KAAA,CAAA;AACA,KAvEA;AAyEA;AACA,IAAA,WA1EA,yBA0EA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,UAAA,OAAA,GAAA,IAAA,CAAA,UAAA,CAAA,OAAA;AACA,MAAA,IAAA,CAAA,UAAA,GAAA,EAAA,CAHA,CAGA;;AACA,MAAA,IAAA,CAAA,UAAA,CAAA,OAAA,GAAA,OAAA;AACA,MAAA,IAAA,CAAA,QAAA,CAAA,KAAA,WAAA,CAAA,OAAA;AACA,KAhFA;AAiFA,IAAA,YAAA,EAAA,sBAAA,KAAA,EAAA,UAAA,EAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,UAAA,CAAA,CAAA,CAAA,EAAA,UAAA,CAAA,CAAA,CAAA;AACA,WAAA,UAAA,CAAA,gBAAA,GAAA,UAAA,CAAA,CAAA,CAAA;AACA,WAAA,UAAA,CAAA,cAAA,GAAA,UAAA,CAAA,CAAA,CAAA;AACA,KArFA;AAsFA,IAAA,QAtFA,oBAsFA,KAtFA,EAsFA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA;AACA,KAxFA;AA0FA,IAAA,SA1FA,qBA0FA,MA1FA,EA0FA;AACA,UAAA,IAAA,GAAA,IAAA;AAAA,UAAA,KAAA,GAAA,EAAA;;AACA,UAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,IAAA;AACA,QAAA,KAAA,GAAA,SAAA;AACA,OAHA,MAGA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,QAAA;AACA,OAHA,MAGA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,MAAA;AACA,OAHA,MAGA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,SAAA;AACA;;AACA,aAAA;AAAA,QAAA,IAAA,EAAA,IAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAAA;AACA,KA1GA;AA2GA,IAAA,SA3GA,qBA2GA,MA3GA,EA2GA;AACA,UAAA,IAAA,GAAA,IAAA;AAAA,UACA,KAAA,GAAA,EADA;;AAEA,UAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,SAAA;AACA,OAHA,MAGA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,QAAA;AACA,OAHA,MAGA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,OAAA;AACA,OAHA,MAGA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,IAAA,GAAA,KAAA;AACA,QAAA,KAAA,GAAA,KAAA;AACA;;AACA,aAAA;AAAA,QAAA,IAAA,EAAA,IAAA;AAAA,QAAA,KAAA,EAAA;AAAA,OAAA;AACA,KA5HA;AA6HA,IAAA,KA7HA,iBA6HA,CA7HA,EA6HA;AAAA;;AACA,UAAA,CAAA,CAAA,CAAA,SAAA,IAAA,CAAA,CAAA,SAAA,IAAA,MAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,QAAA;AACA;AACA;;AACA,WAAA,IAAA,CAAA,EAAA,GAAA,CAAA,CAAA,EAAA;AACA,WAAA,IAAA,CAAA,SAAA,GAAA,CAAA,CAAA,SAAA;AACA,WAAA,IAAA,CAAA,KAAA,GAAA,CAAA,CAAA,KAAA,CAPA,CAQA;;AACA,WAAA,SAAA,CAAA,KAAA,GAAA,CAAA,YAAA,EAAA;AAAA,QAAA,SAAA,EAAA,CAAA,CAAA,SAAA;AAAA,QAAA,OAAA,EAAA,CAAA,CAAA,OAAA;AAAA,QAAA,SAAA,EAAA,CAAA,CAAA;AAAA,OAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,cAAA,GAAA,CAAA,MAAA,CAAA,IAAA,IAAA,CAAA,IAAA,GAAA,CAAA,MAAA,CAAA,IAAA,IAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,SAAA,GAAA,IAAA;AACA,YAAA,MAAA,CAAA,YAAA,GAAA,IAAA;AACA,YAAA,MAAA,CAAA,IAAA,CAAA,YAAA,GAAA,IAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,KAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,EAAA;AACA;AACA;;AACA,UAAA,MAAA,CAAA,IAAA,CAAA,YAAA,GAAA,KAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,KAAA;;AACA,cAAA,GAAA,CAAA,MAAA,CAAA,KAAA,IAAA,GAAA,CAAA,MAAA,CAAA,KAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,EAAA;AACA,YAAA,MAAA,CAAA,YAAA,GAAA,GAAA,CAAA,MAAA,CAAA,KAAA,CAFA,CAGA;;AACA,gBAAA,GAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,MAAA,CAAA,KAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,cAAA,GAAA,CAAA,IAAA,CAAA,CAAA,CAAA,QAAA;AACA,aAFA;AAGA,YAAA,MAAA,CAAA,IAAA,CAAA,SAAA,GAAA,GAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,IAAA;AACA,WAVA,MAUA;AACA,YAAA,MAAA,CAAA,IAAA,CAAA,SAAA,GAAA,EAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,IAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,uBAAA;AACA;;AACA,cAAA,MAAA,CAAA,KAAA,EAAA;AACA,YAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,MAAA,CAAA,KAAA;;AACA;AACA;;AACA,UAAA,MAAA,CAAA,YAAA,GAAA,IAAA;AACA,SA/BA,MA+BA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,OAnCA;AAqCA,KA3KA;AA4KA,IAAA,WA5KA,yBA4KA;AAAA;;AACA,UAAA,KAAA,UAAA,IAAA,KAAA,IAAA,CAAA,SAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,aAAA,KAAA,GAAA,YAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,KAAA,KAAA;AACA;AACA,OAJA,MAIA;AACA,aAAA,KAAA,GAAA,EAAA;AACA;;AACA,WAAA,aAAA,GAAA,IAAA;AACA,UAAA,MAAA,GAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,KAAA,IAAA,CAAA;AACA,MAAA,MAAA,CAAA,SAAA,GAAA,MAAA,CAAA,SAAA,CAAA,IAAA,CAAA,GAAA,CAAA;AACA,WAAA,cAAA,CAAA,KAAA,GAAA,CAAA,aAAA,EAAA,MAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,MAAA;;AACA,UAAA,MAAA,CAAA,QAAA;;AACA,UAAA,MAAA,CAAA,YAAA,GAAA,KAAA;AACA,SAJA,MAIA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,OARA,EAQA,OARA,CAQA;AAAA,eAAA,MAAA,CAAA,aAAA,GAAA,KAAA;AAAA,OARA;AASA,KAhMA;AAiMA,IAAA,IAjMA,gBAiMA,CAjMA,EAiMA,MAjMA,EAiMA;AACA,UAAA,CAAA,CAAA,CAAA,SAAA,EAAA;AACA,aAAA,QAAA,CAAA,OAAA,CACA,qBADA;AAGA;AACA;;AACA,MAAA,MAAA,GAAA,MAAA,IAAA,KAAA;AACA,WAAA,MAAA,CAAA,QAAA,GAAA,MAAA;AACA,WAAA,MAAA,CAAA,KAAA,GAAA,cAAA,CAAA,CAAA,KAAA;AACA,UAAA,MAAA,EAAA,KAAA,MAAA,CAAA,KAAA,GAAA,cAAA,CAAA,CAAA,KAAA;AACA,WAAA,MAAA,CAAA,aAAA,GAAA,KAAA,gBAAA,CAAA,CAAA,CAAA,SAAA,EAAA,SAAA;AACA,WAAA,MAAA,CAAA,WAAA,GAAA,CAAA;AACA,WAAA,MAAA,CAAA,KAAA,GAAA,KAAA;AACA,WAAA,MAAA,CAAA,OAAA,GAAA,IAAA;AACA,KAhNA;AAiNA,IAAA,MAjNA,kBAiNA,CAjNA,EAiNA;AAAA;;AACA,WAAA,cAAA,CAAA,KAAA,GAAA,CAAA,QAAA,EAAA;AAAA,QAAA,GAAA,EAAA,CAAA,CAAA;AAAA,OAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,GAAA,CAAA,OAAA;;AACA,UAAA,MAAA,CAAA,QAAA;AACA,SAHA,MAGA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,OAPA;AAQA,KA1NA;AA2NA,IAAA,MA3NA,kBA2NA,CA3NA,EA2NA;AACA,WAAA,UAAA,CAAA,EAAA,GAAA,CAAA,CAAA,EAAA;AACA,WAAA,UAAA,CAAA,UAAA,GAAA,CAAA,CAAA,UAAA;AACA,WAAA,kBAAA,GAAA,IAAA;AACA,KA/NA;AAgOA,IAAA,kBAhOA,gCAgOA;AAAA;;AACA,WAAA,aAAA,GAAA,IAAA;AACA,WAAA,cAAA,CAAA,KAAA,GAAA,CAAA,WAAA,EAAA,KAAA,UAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,OAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,MAAA;;AACA,UAAA,MAAA,CAAA,QAAA;;AACA,UAAA,MAAA,CAAA,kBAAA,GAAA,KAAA;AACA,SAJA,MAIA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,OARA,EAQA,OARA,CAQA;AAAA,eAAA,MAAA,CAAA,aAAA,GAAA,KAAA;AAAA,OARA;AASA,KA3OA;AA4OA,IAAA,OA5OA,mBA4OA,CA5OA,EA4OA;AACA,UAAA,CAAA,CAAA,CAAA,UAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,WAAA;AACA;AACA;;AACA,WAAA,UAAA,GAAA,CAAA,CAAA,UAAA;AACA,WAAA,cAAA,GAAA,IAAA;AACA,KAnPA;AAoPA,IAAA,MApPA,kBAoPA,CApPA,EAoPA;AACA,WAAA,IAAA,CAAA,CAAA,EAAA,IAAA;AACA,KAtPA;AAuPA,IAAA,iBAvPA,6BAuPA,UAvPA,EAuPA,OAvPA,EAuPA,MAvPA,EAuPA;AACA;AACA;AACA,UAAA,MAAA,CAAA,IAAA,CAAA,MAAA,EAAA,MAAA,GAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA,MAAA,GAAA,MAAA,CAAA,KAAA;AACA,aAAA,OAAA,CAAA,KAAA,GAAA,YAAA,MAAA,CAAA,KAAA,GAAA,KAAA,GAAA,MAAA;AACA;;AACA,WAAA,WAAA,GAAA,UAAA,CAPA,CAQA;AACA,KAhQA;AAiQA,IAAA,QAjQA,sBAiQA;AACA,WAAA,cAAA;AACA,KAnQA;AAoQA,IAAA,eApQA,2BAoQA,KApQA,EAoQA;AACA,WAAA,gBAAA,GAAA,KAAA;AACA,WAAA,cAAA;AACA,KAvQA;AAwQA,IAAA,aAxQA,yBAwQA,CAxQA,EAwQA;AACA,UAAA,CAAA,CAAA,CAAA,SAAA,EAAA;AACA,aAAA,QAAA,CAAA,OAAA,CACA,qBADA;AAGA;AACA;;AACA,WAAA,MAAA,CAAA,aAAA,GAAA,KAAA,gBAAA,CAAA,CAAA,CAAA,SAAA,EAAA,SAAA;AACA,WAAA,MAAA,CAAA,KAAA,GAAA,UAAA,CAAA,CAAA,IAAA;AACA,WAAA,MAAA,CAAA,KAAA,GAAA,IAAA;AACA,WAAA,MAAA,CAAA,WAAA,GAAA,CAAA;AACA,WAAA,MAAA,CAAA,OAAA,GAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA,EAAA,CAAA;AACA,KArRA;AAsRA,IAAA,QAtRA,oBAsRA,QAtRA,EAsRA;AACA,WAAA,MAAA,CAAA,OAAA,GAAA,KAAA;AACA,WAAA,QAAA;AACA;AAzRA;AApEA,CAAA","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\">\r\n    <!-- 查询区域 -->\r\n    <div class=\"table-page-search-wrapper\">\r\n      <a-form layout=\"inline\" @keyup.enter.native=\"searchQuery\">\r\n        <a-row :gutter=\"24\">\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"标题\">\r\n              <a-input placeholder=\"请输入搜索关键词\" v-model=\"queryParam.title\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"状态\">\r\n              <a-select v-model=\"queryParam.status\" placeholder=\"请选择\" :allowClear=\"true\" >\r\n                <a-select-option value=\"0\">草稿</a-select-option>\r\n                <a-select-option value=\"1\">处理中</a-select-option>\r\n                <a-select-option value=\"2\">已结束</a-select-option>\r\n                <a-select-option value=\"3\">已撤回</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"结果\">\r\n              <a-select v-model=\"queryParam.result\" placeholder=\"请选择\" :allowClear=\"true\" >\r\n                <a-select-option value=\"0\">未提交</a-select-option>\r\n                <a-select-option value=\"1\">处理中</a-select-option>\r\n                <a-select-option value=\"2\">通过</a-select-option>\r\n                <a-select-option value=\"3\">驳回</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"10\">\r\n            <a-form-item label=\"创建时间\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\r\n              <a-range-picker\r\n                style=\"width: 210px\"\r\n                v-model=\"queryParam.createTimeRange\"\r\n                format=\"YYYY-MM-DD\"\r\n                :placeholder=\"['开始时间', '结束时间']\"\r\n                @change=\"onDateChange\"\r\n                @ok=\"onDateOk\"\r\n              />\r\n            </a-form-item>\r\n          </a-col>\r\n\r\n          <span style=\"float: left;overflow: hidden;\" class=\"table-page-search-submitButtons\">\r\n            <a-col :md=\"6\" :sm=\"12\" >\r\n                <a-button type=\"primary\"  style=\"left: 10px\" @click=\"searchQuery\" icon=\"search\">查询</a-button>\r\n                <a-button type=\"primary\"  @click=\"searchReset\" icon=\"reload\" style=\"margin-left: 8px;left: 10px\">重置</a-button>\r\n            </a-col>\r\n          </span>\r\n          <span style=\"float: right;overflow: hidden;\" class=\"table-page-search-submitButtons\">\r\n            <a-col :md=\"12\" :sm=\"12\" >\r\n                <a-button type=\"primary\" @click=\"addApply\" :loading=\"addApplyLoading\" style=\"left: 10px\"  icon=\"plus-circle\">发起申请</a-button>\r\n            </a-col>\r\n          </span>\r\n\r\n        </a-row>\r\n      </a-form>\r\n    </div>\r\n\r\n    <!-- table区域-begin -->\r\n    <a-table :scroll=\"scroll\" bordered\r\n      ref=\"table\"\r\n      size=\"middle\"\r\n      rowKey=\"id\"\r\n      :dataSource=\"dataSource\"\r\n      :pagination=\"ipagination\"\r\n      :loading=\"loading\"\r\n      @change=\"handleTableChange\">\r\n      <a-table-column title=\"#\"  :width=\"50\">\r\n        <template slot-scope=\"t,r,i\" >\r\n          <span> {{i+1}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"标题\" dataIndex=\"title\"  :width=\"150\" align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <span> {{t}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"所属流程\" dataIndex=\"processName\"  :width=\"150\" align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <span> {{t}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"当前审批环节\" dataIndex=\"currTaskName\"  :width=\"150\" align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <span> {{t}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"状态\" dataIndex=\"status\"  :width=\"150\" align=\"center\"\r\n        key=\"s\" :sorter=\"(a,b)=>a.status - b.status\"\r\n      >\r\n        <template slot-scope=\"t,r,i\">\r\n          <span :style=\"{color:getStatus(t).color}\"> {{getStatus(t).text}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"结果\" dataIndex=\"result\"  :width=\"150\" align=\"center\"\r\n                      key=\"result\" :sorter=\"(a,b)=>a.result - b.result\"\r\n      >\r\n        <template slot-scope=\"t,r,i\">\r\n          <span :style=\"{color:getResult(t).color}\"> {{getResult(t).text}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"创建时间\" dataIndex=\"createTime\"  :width=\"150\" align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <span> {{t}} </span>\r\n        </template>\r\n      </a-table-column>\r\n      <a-table-column title=\"提交申请时间\" dataIndex=\"applyTime\"  :width=\"150\" align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <span> {{t}} </span>\r\n        </template>\r\n      </a-table-column><!--\r\n      <a-table-column title=\"流程实例状态\" dataIndex=\"procInstStatus\"  :width=\"150\" align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <span> {{t}} </span>\r\n        </template>\r\n      </a-table-column>-->\r\n      <a-table-column title=\"操作\" dataIndex=\"\"  align=\"center\">\r\n        <template slot-scope=\"t,r,i\">\r\n          <template v-if=\"r.status == 0\">\r\n            <a href=\"javascript:void(0);\" style=\"color: #00A0E9\" @click=\"apply(r)\" >提交申请</a>\r\n            <a-divider type=\"vertical\" />\r\n            <a href=\"javascript:void(0);\" @click=\"edit(r)\" style=\"color: #000000\">编辑提交数据</a>\r\n            <a-divider type=\"vertical\" />\r\n            <a-popconfirm title=\"确定删除吗?\" @confirm=\"() => remove(r)\">\r\n              <a href=\"javascript:void(0);\"  style=\"color: red\">删除</a>\r\n            </a-popconfirm>\r\n\r\n          </template>\r\n          <template v-else-if=\"r.status == 1\">\r\n\r\n            <a href=\"javascript:void(0);\" v-if=\"r.procInstStatus == 1\" @click=\"cancel(r)\"  style=\"color:#8000ff;\">撤回</a>\r\n            <a-divider type=\"vertical\" v-if=\"r.procInstStatus == 1\"/>\r\n            <a href=\"javascript:void(0);\" @click=\"history(r)\" style=\"color:blue;\">查看进度</a>\r\n            <a-divider type=\"vertical\" />\r\n            <a href=\"javascript:void(0);\" @click=\"detail(r)\" style=\"color:#999;\">表单数据</a>\r\n          </template>\r\n          <template v-else-if=\"(r.status == 2 && r.result == 3) || r.status == 3\">\r\n            <a-popconfirm title=\"确定提交申请吗?\" @confirm=\"() => apply(r)\">\r\n              <a href=\"javascript:void(0);\" style=\"color:#00A0E9;\">重新申请</a>\r\n            </a-popconfirm>\r\n            <a-divider type=\"vertical\" />\r\n            <a href=\"javascript:void(0);\" @click=\"edit(r)\" style=\"color:#000000;\">编辑</a>\r\n            <a-divider type=\"vertical\" />\r\n            <a href=\"javascript:void(0);\" @click=\"history(r)\" style=\"color:blue;\">审批历史</a>\r\n          </template>\r\n          <template v-else>\r\n            <a href=\"javascript:void(0);\" @click=\"detail(r)\" style=\"color:#999;\">表单数据</a>\r\n            <a-divider type=\"vertical\" />\r\n            <a href=\"javascript:void(0);\" @click=\"history(r)\" style=\"color:blue;\">审批历史</a>\r\n          </template>\r\n\r\n        </template>\r\n      </a-table-column>\r\n    </a-table>\r\n    <!-- table区域-end -->\r\n    <!--流程申请选择-->\r\n    <a-drawer\r\n      title=\"选择流程\" width=\"33%\"\r\n      placement=\"right\"\r\n      :closable=\"false\"\r\n      @close=\"processModalVisible = false\"\r\n      :visible=\"processModalVisible\"\r\n    >\r\n      <a-empty description=\"无流程可供选择\" v-if=\"activeKeyAll.length==0\" />\r\n      <div v-else>\r\n        <a-input-search style=\"margin-bottom: 10px;width: 200px\"\r\n                        placeholder=\"输入流程名称\" @search=\"onSearchProcess\" />\r\n        <a-collapse v-model=\"activeKey\">\r\n          <a-collapse-panel v-for=\"(value, index)  in activeKeyAll\" :header=\"filterDictText(dictOptions,value)||'未分类'\" :key=\"value\">\r\n            <a-list :grid=\"{ gutter: 10,column:1}\" :dataSource=\"processDataMap[value]\">\r\n              <a-list-item slot=\"renderItem\" slot-scope=\"item\">\r\n                <a-card>\r\n                  <div slot=\"title\">\r\n                    <a-row>\r\n                      <a-col span=\"12\" :title=\"item.name\">{{item.name}} </a-col>\r\n                      <a-col span=\"12\" style=\"text-align: right;\">\r\n                        <a href=\"javascript:void (0)\" @click=\"chooseProcess(item)\">发起申请</a>\r\n                      </a-col>\r\n                    </a-row>\r\n                  </div>\r\n                  <b>版本：</b>v.{{item.version}}\r\n                  <br/>\r\n                  <b>说明：</b>{{item.description}}\r\n                </a-card>\r\n              </a-list-item>\r\n            </a-list>\r\n          </a-collapse-panel>\r\n        </a-collapse>\r\n      </div>\r\n    </a-drawer>\r\n    <!--流程表单-->\r\n    <a-modal :title=\"lcModa.title\" v-model=\"lcModa.visible\" :footer=\"null\" :maskClosable=\"false\" width=\"80%\">\r\n      <component :disabled=\"lcModa.disabled\" v-if=\"lcModa.visible\" :is=\"lcModa.formComponent\"\r\n                 :processData=\"lcModa.processData\" :isNew = \"lcModa.isNew\"\r\n                 @afterSubmit=\"afterSub\" @close=\"lcModa.visible=false,lcModa.disabled = false\"></component>\r\n    </a-modal>\r\n    <!--提交申请表单-->\r\n    <a-modal title=\"提交申请\" v-model=\"modalVisible\" :mask-closable=\"false\" :width=\"500\" :footer=\"null\">\r\n      <div v-if=\"modalVisible\">\r\n        <a-form-item label=\"选择审批人\" v-show=\"showAssign\">\r\n          <a-select style=\"width: 100%\"\r\n            v-model=\"form.assignees\"\r\n            placeholder=\"请选择\"\r\n            mode=\"multiple\"\r\n            :allowClear=\"true\"\r\n          >\r\n            <a-select-option v-for=\"(item, i) in assigneeList\" :key=\"i\" :value=\"item.username\">{{item.realname}}</a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item label=\"下一审批人\" v-show=\"isGateway\">\r\n          <a-alert  type=\"info\" showIcon message=\"分支网关处不支持自定义选择下一审批人，将自动下发给所有可审批人。\">，将发送给下一节点所有人</a-alert>\r\n        </a-form-item>\r\n        <a-form-item label=\"优先级\" prop=\"priority\">\r\n          <a-select v-model=\"form.priority\" placeholder=\"请选择\" :allowClear=\"true\" style=\"width: 100%\">\r\n            <a-select-option :value=\"0\">普通</a-select-option>\r\n            <a-select-option :value=\"1\">重要</a-select-option>\r\n            <a-select-option :value=\"2\">紧急</a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item label=\"消息通知\">\r\n          <a-checkbox v-model=\"form.sendMessage\">站内消息通知</a-checkbox>\r\n          <a-checkbox v-model=\"form.sendSms\" disabled>短信通知</a-checkbox>\r\n          <a-checkbox v-model=\"form.sendEmail\" disabled>邮件通知</a-checkbox>\r\n        </a-form-item>\r\n        <div slot=\"footer\">\r\n          <a-button type=\"text\" @click=\"modalVisible=false\">取消</a-button>\r\n          <div style=\"display:inline-block;width: 20px;\"></div>\r\n          <a-button type=\"primary\" :disabled=\"submitLoading\" @click=\"applySubmit\">提交</a-button>\r\n        </div>\r\n      </div>\r\n    </a-modal>\r\n    <a-modal title=\"审批历史\" v-model=\"modalLsVisible\" :mask-closable=\"false\" :width=\"'80%'\" :footer=\"null\">\r\n      <div v-if=\"modalLsVisible\">\r\n        <historicDetail :procInstId=\"procInstId\"></historicDetail>\r\n      </div>\r\n    </a-modal>\r\n    <a-modal title=\"确认撤回\" v-model=\"modalCancelVisible\" :mask-closable=\"false\" :width=\"500\">\r\n      <a-form ref=\"delForm\" v-model=\"cancelForm\" :label-width=\"70\" v-if=\"modalCancelVisible\">\r\n        <a-form-item label=\"撤回原因\" prop=\"reason\">\r\n          <a-input type=\"textarea\" v-model=\"cancelForm.reason\" :rows=\"4\" />\r\n        </a-form-item>\r\n      </a-form>\r\n      <div slot=\"footer\">\r\n        <a-button type=\"text\" @click=\"modalCancelVisible=false\">取消</a-button>\r\n        <a-button type=\"primary\" :disabled=\"submitLoading\" @click=\"handelSubmitCancel\">提交</a-button>\r\n      </div>\r\n    </a-modal>\r\n  </a-card>\r\n\r\n</template>\r\n\r\n<script>\r\n  import { JeecgListMixin } from '@/mixins/JeecgListMixin'\r\n  import { activitiMixin } from '@/views/activiti/mixins/activitiMixin'\r\n  import { filterObj } from '@/utils/util';\r\n  import JEllipsis from '@/components/jeecg/JEllipsis'\r\n  import { deleteAction, getAction,downFile } from '@/api/manage'\r\n  import pick from \"lodash.pick\";\r\n  import JTreeSelect from '@/components/jeecg/JTreeSelect'\r\n  import {initDictOptions, filterDictText} from '@/components/dict/JDictSelectUtil'\r\n  import historicDetail from '@/views/activiti/historicDetail'\r\n  export default {\r\n    name: \"applyList\",\r\n    mixins:[activitiMixin,JeecgListMixin],\r\n    components: {\r\n      JEllipsis\r\n      ,JTreeSelect\r\n      ,historicDetail\r\n    },\r\n    data () {\r\n      return {\r\n        description: '我的申请',\r\n        dictOptions:[],\r\n        url: {\r\n          list: \"/actBusiness/listData\",\r\n          getProcessDataList: \"/activiti_process/listData\",\r\n          delByIds:'/actBusiness/delByIds',\r\n          getFirstNode:'/actProcessIns/getFirstNode',\r\n          applyBusiness:'/actBusiness/apply',\r\n          cancelApply:'/actBusiness/cancel',\r\n        },\r\n        // 查询条件\r\n        queryParam: {\r\n          createTimeRange:[],\r\n          keyWord:'',\r\n        },\r\n        // 表头\r\n        labelCol: {\r\n          xs: { span: 4 },\r\n          sm: { span: 4 },\r\n        },\r\n        wrapperCol: {\r\n          xs: { span: 20 },\r\n          sm: { span: 20 },\r\n        },\r\n        processModalVisible: null,\r\n        activeKeyAll: [],\r\n        activeKey: [],\r\n        processDataMap: {},\r\n        searchProcessKey: null,\r\n        addApplyLoading: false,\r\n        lcModa: {\r\n          title:'',\r\n          disabled:false,\r\n          visible:false,\r\n          formComponent : null,\r\n          isNew : false\r\n        },\r\n        form:{\r\n          priority:0,\r\n          assignees:[],\r\n          sendMessage:true\r\n        },\r\n        modalVisible: false,\r\n        showAssign: false,\r\n        assigneeList: [],\r\n        isGateway: false,\r\n        dictPriority: [],\r\n        submitLoading: false,\r\n        error: \"\",\r\n        /*审批历史*/\r\n        modalLsVisible: false,\r\n        procInstId: '',\r\n        modalCancelVisible: false,\r\n        cancelForm: {}\r\n      }\r\n    },\r\n    computed:{\r\n    },\r\n    methods: {\r\n\r\n      initDictConfig() {\r\n        //初始化字典 - 流程分类\r\n        initDictOptions('bpm_process_type').then((res) => {\r\n          if (res.success) {\r\n            this.dictOptions = res.result;\r\n          }\r\n        });\r\n      },\r\n      filterDictText(dictOptions, text) {\r\n        if (dictOptions instanceof Array) {\r\n          for (let dictItem of dictOptions) {\r\n            if (text === dictItem.value) {\r\n              return dictItem.text\r\n            }\r\n          }\r\n        }\r\n        return text||text=='null'?'':text\r\n      },\r\n      getProcessList() {\r\n        this.addApplyLoading = true;\r\n        this.getAction(this.url.getProcessDataList,{status:1,roles:true}).then(res => {\r\n          this.activeKeyAll = [];\r\n          if (res.success) {\r\n            var result = res.result||[];\r\n            if (result.length>0){\r\n              let searchProcessKey = this.searchProcessKey;\r\n              if (searchProcessKey){ //过滤条件\r\n                result = _.filter(result, function(o) { return o.name.indexOf(searchProcessKey)>-1; });\r\n              }\r\n              this.processDataMap = _.groupBy(result,'categoryId');\r\n              for (const categoryId in this.processDataMap) {\r\n                this.activeKeyAll.push(categoryId)\r\n              }\r\n              this.activeKey = this.activeKeyAll;\r\n            }\r\n            this.processModalVisible = true;\r\n          }else {\r\n            this.$message.warning(res.message)\r\n          }\r\n        }).finally(()=>this.addApplyLoading = false);\r\n      },\r\n      loadData(arg) {\r\n        console.log(\"loadData\")\r\n        if(!this.url.list){\r\n          this.$message.error(\"请设置url.list属性!\")\r\n          return\r\n        }\r\n        //加载数据 若传入参数1则加载第一页的内容\r\n        if (arg === 1) {\r\n          this.ipagination.current = 1;\r\n        }\r\n        var params = this.getQueryParams();//查询条件\r\n        this.loading = true;\r\n        getAction(this.url.list, params).then((res) => {\r\n          if (res.success) {\r\n            let records = res.result||[];\r\n            this.dataSource = records;\r\n            this.ipagination.total = records.length;\r\n          }\r\n          if(res.code===510){\r\n            this.$message.warning(res.message)\r\n          }\r\n          this.loading = false;\r\n        })\r\n      },\r\n      getQueryParams(){\r\n        var param = Object.assign({}, this.queryParam,this.isorter);\r\n        delete param.createTimeRange; // 时间参数不传递后台\r\n        return filterObj(param);\r\n      },\r\n\r\n      // 重置\r\n      searchReset(){\r\n        var that = this;\r\n        var logType = that.queryParam.logType;\r\n        that.queryParam = {}; //清空查询区域参数\r\n        that.queryParam.logType = logType;\r\n        that.loadData(this.ipagination.current);\r\n      },\r\n      onDateChange: function (value, dateString) {\r\n        console.log(dateString[0],dateString[1]);\r\n        this.queryParam.createTime_begin=dateString[0];\r\n        this.queryParam.createTime_end=dateString[1];\r\n      },\r\n      onDateOk(value) {\r\n        console.log(value);\r\n      },\r\n\r\n      getStatus(status) {\r\n        let text = \"未知\", color = \"\";\r\n        if (status == 0) {\r\n          text = \"草稿\";\r\n          color = \"default\";\r\n        } else if (status == 1) {\r\n          text = \"处理中\";\r\n          color = \"orange\";\r\n        } else if (status == 2) {\r\n          text = \"已结束\";\r\n          color = \"blue\";\r\n        } else if (status == 3) {\r\n          text = \"已撤回\";\r\n          color = \"magenta\";\r\n        }\r\n        return {text:text,color:color}\r\n      },\r\n      getResult(result) {\r\n        let text = \"未知\",\r\n          color = \"\";\r\n        if (result == 0) {\r\n          text = \"未提交\";\r\n          color = \"default\";\r\n        } else if (result == 1) {\r\n          text = \"处理中\";\r\n          color = \"orange\";\r\n        } else if (result == 2) {\r\n          text = \"已通过\";\r\n          color = \"green\";\r\n        } else if (result == 3) {\r\n          text = \"已驳回\";\r\n          color = \"red\";\r\n        }\r\n        return {text:text,color:color}\r\n      },\r\n      apply(v) {\r\n        if (!v.procDefId || v.procDefId == \"null\") {\r\n          this.$message.error(\"流程定义为空\");\r\n          return;\r\n        }\r\n        this.form.id = v.id;\r\n        this.form.procDefId = v.procDefId;\r\n        this.form.title = v.title;\r\n        // 加载审批人\r\n        this.getAction(this.url.getFirstNode,{procDefId:v.procDefId,tableId:v.tableId,tableName:v.tableName}).then(res => {\r\n          if (res.success) {\r\n            if (res.result.type == 3 || res.result.type == 4) {\r\n              this.isGateway = true;\r\n              this.modalVisible = true;\r\n              this.form.firstGateway = true;\r\n              this.showAssign = false;\r\n              this.error = \"\";\r\n              return;\r\n            }\r\n            this.form.firstGateway = false;\r\n            this.isGateway = false;\r\n            if (res.result.users && res.result.users.length > 0) {\r\n              this.error = \"\";\r\n              this.assigneeList = res.result.users;\r\n              // 默认勾选\r\n              let ids = [];\r\n              res.result.users.forEach(e => {\r\n                ids.push(e.username);\r\n              });\r\n              this.form.assignees = ids;\r\n              this.showAssign = true;\r\n            } else {\r\n              this.form.assignees = [];\r\n              this.showAssign = true;\r\n              this.error = '审批节点未分配候选审批人员，请联系管理员！';\r\n            }\r\n            if (this.error){\r\n              this.$message.error(this.error)\r\n              return;\r\n            }\r\n            this.modalVisible = true;\r\n          }else {\r\n            this.$message.error(res.message)\r\n          }\r\n        });\r\n\r\n      },\r\n      applySubmit() {\r\n        if (this.showAssign && this.form.assignees.length < 1) {\r\n          this.error = \"请至少选择一个审批人\";\r\n          this.$message.error(this.error)\r\n          return;\r\n        } else {\r\n          this.error = \"\";\r\n        }\r\n        this.submitLoading = true;\r\n        var params = Object.assign({},this.form);\r\n        params.assignees = params.assignees.join(\",\")\r\n        this.postFormAction(this.url.applyBusiness,params).then(res => {\r\n          if (res.success) {\r\n            this.$message.success(\"操作成功\");\r\n            this.loadData();\r\n            this.modalVisible = false;\r\n          }else {\r\n            this.$message.error(res.message)\r\n          }\r\n        }).finally(()=>this.submitLoading = false);\r\n      },\r\n      edit(r,isView) {\r\n        if (!r.routeName) {\r\n          this.$message.warning(\r\n            \"该流程信息未配置表单，请联系开发人员！\"\r\n          );\r\n          return;\r\n        }\r\n        isView = isView||false;\r\n        this.lcModa.disabled = isView;\r\n        this.lcModa.title = '修改流程业务信息：'+r.title;\r\n        if (isView) this.lcModa.title = '查看流程业务信息：'+r.title;\r\n        this.lcModa.formComponent = this.getFormComponent(r.routeName).component;\r\n        this.lcModa.processData = r;\r\n        this.lcModa.isNew = false;\r\n        this.lcModa.visible = true;\r\n      },\r\n      remove(r) {\r\n        this.postFormAction(this.url.delByIds,{ids:r.id}).then((res)=>{\r\n          if (res.success){\r\n            this.$message.success(res.message)\r\n            this.loadData();\r\n          }else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n      },\r\n      cancel(v) {\r\n        this.cancelForm.id = v.id;\r\n        this.cancelForm.procInstId = v.procInstId;\r\n        this.modalCancelVisible = true;\r\n      },\r\n      handelSubmitCancel() {\r\n        this.submitLoading = true;\r\n        this.postFormAction(this.url.cancelApply,this.cancelForm).then(res => {\r\n          if (res.success) {\r\n            this.$message.success(\"操作成功\");\r\n            this.loadData();\r\n            this.modalCancelVisible = false;\r\n          }else {\r\n            this.$message.error(res.message);\r\n          }\r\n        }).finally(()=>this.submitLoading = false);\r\n      },\r\n      history(v) {\r\n        if (!v.procInstId) {\r\n          this.$message.error(\"流程实例ID不存在\");\r\n          return;\r\n        }\r\n        this.procInstId = v.procInstId;\r\n        this.modalLsVisible = true;\r\n      },\r\n      detail(v) {\r\n        this.edit(v,true);\r\n      },\r\n      handleTableChange(pagination, filters, sorter) {\r\n        //分页、排序、筛选变化时触发\r\n        //TODO 筛选\r\n        if (Object.keys(sorter).length > 0) {\r\n          this.isorter.column = sorter.field;\r\n          this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\"\r\n        }\r\n        this.ipagination = pagination;\r\n        // this.loadData();\r\n      },\r\n      addApply() {\r\n        this.getProcessList()\r\n      },\r\n      onSearchProcess(value) {\r\n        this.searchProcessKey = value;\r\n        this.getProcessList()\r\n      },\r\n      chooseProcess(v) {\r\n        if (!v.routeName) {\r\n          this.$message.warning(\r\n            \"该流程信息未配置表单，请联系开发人员！\"\r\n          );\r\n          return;\r\n        }\r\n        this.lcModa.formComponent = this.getFormComponent(v.routeName).component;\r\n        this.lcModa.title = '发起流程：'+v.name;\r\n        this.lcModa.isNew = true;\r\n        this.lcModa.processData = v;\r\n        this.lcModa.visible = true;\r\n        console.log(\"发起\",v)\r\n      },\r\n      afterSub(formData){\r\n          this.lcModa.visible = false;\r\n          this.loadData();\r\n      },\r\n\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n  @import '~@assets/less/common.less';\r\n</style>"],"sourceRoot":"src/views/activiti"}]}