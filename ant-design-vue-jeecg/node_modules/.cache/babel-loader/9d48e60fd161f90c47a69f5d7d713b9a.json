{"remainingRequest":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\components\\table\\index.js","dependencies":[{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\components\\table\\index.js","mtime":1611914356000},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1617935819779}],"contextDependencies":[],"result":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport T from \"ant-design-vue/es/table/Table\";\nimport get from \"lodash.get\";\nexport default {\n  data: function data() {\n    return {\n      needTotalList: [],\n      selectedRows: [],\n      selectedRowKeys: [],\n      localLoading: false,\n      localDataSource: [],\n      localPagination: Object.assign({}, T.props.pagination)\n    };\n  },\n  props: Object.assign({}, T.props, {\n    rowKey: {\n      type: [String, Function],\n      default: 'id'\n    },\n    data: {\n      type: Function,\n      required: true\n    },\n    pageNum: {\n      type: Number,\n      default: 1\n    },\n    pageSize: {\n      type: Number,\n      default: 10\n    },\n    showSizeChanger: {\n      type: Boolean,\n      default: true\n    },\n    showAlertInfo: {\n      type: Boolean,\n      default: false\n    },\n    showPagination: {\n      default: 'auto'\n    }\n  }),\n  watch: {\n    'localPagination.current': function localPaginationCurrent(val) {\n      this.$router.push({\n        name: this.$route.name,\n        params: Object.assign({}, this.$route.params, {\n          pageNo: val\n        })\n      });\n    },\n    pageNum: function pageNum(val) {\n      Object.assign(this.localPagination, {\n        current: val\n      });\n    },\n    pageSize: function pageSize(val) {\n      console.log('pageSize:', val);\n      Object.assign(this.localPagination, {\n        pageSize: val\n      });\n    },\n    showSizeChanger: function showSizeChanger(val) {\n      console.log('showSizeChanger', val);\n      Object.assign(this.localPagination, {\n        showSizeChanger: val\n      });\n    }\n  },\n  created: function created() {\n    this.localPagination = ['auto', true].includes(this.showPagination) && Object.assign({}, this.localPagination, {\n      current: this.pageNum,\n      pageSize: this.pageSize,\n      showSizeChanger: this.showSizeChanger\n    });\n    this.needTotalList = this.initTotalList(this.columns);\n    this.loadData();\n  },\n  methods: {\n    refresh: function refresh() {\n      this.loadData();\n    },\n    loadData: function loadData(pagination, filters, sorter) {\n      var _this = this;\n\n      this.localLoading = true;\n      var result = this.data(Object.assign({\n        pageNo: pagination && pagination.current || this.localPagination.current,\n        pageSize: pagination && pagination.pageSize || this.localPagination.pageSize\n      }, sorter && sorter.field && {\n        sortField: sorter.field\n      } || {}, sorter && sorter.order && {\n        sortOrder: sorter.order\n      } || {}, _objectSpread({}, filters)));\n\n      if (result instanceof Promise) {\n        result.then(function (r) {\n          _this.localPagination = Object.assign({}, _this.localPagination, {\n            current: r.pageNo,\n            // 返回结果中的当前分页数\n            total: r.totalCount,\n            // 返回结果中的总记录数\n            showSizeChanger: _this.showSizeChanger,\n            pageSize: pagination && pagination.pageSize || _this.localPagination.pageSize\n          }); //update--begin--autor:wangshuai-----date:20200724------for：判断showPagination是否为false------\n\n          (!_this.showPagination || !r.totalCount && _this.showPagination === 'auto') && (_this.localPagination = false); //update--end--autor:wangshuai-----date:20200724------for：判断showPagination是否为false-----\n\n          _this.localDataSource = r.data; // 返回结果中的数组数据\n\n          _this.localLoading = false;\n        });\n      }\n    },\n    initTotalList: function initTotalList(columns) {\n      var totalList = [];\n      columns && columns instanceof Array && columns.forEach(function (column) {\n        if (column.needTotal) {\n          totalList.push(_objectSpread({}, column, {\n            total: 0\n          }));\n        }\n      });\n      return totalList;\n    },\n    updateSelect: function updateSelect(selectedRowKeys, selectedRows) {\n      this.selectedRowKeys = selectedRowKeys;\n      this.selectedRows = selectedRows;\n      var list = this.needTotalList;\n      this.needTotalList = list.map(function (item) {\n        return _objectSpread({}, item, {\n          total: selectedRows.reduce(function (sum, val) {\n            var total = sum + get(val, item.dataIndex);\n            return isNaN(total) ? 0 : total;\n          }, 0)\n        });\n      }); // this.$emit('change', selectedRowKeys, selectedRows)\n    },\n    updateEdit: function updateEdit() {\n      this.selectedRows = [];\n    },\n    onClearSelected: function onClearSelected() {\n      // 【TESTA-262】页面清空后还能才做所选行，增加  this.$emit('clearAll')\n      this.selectedRowKeys = [];\n      this.selectedRows = [];\n      this.updateSelect([], []);\n      this.$emit('clearAll');\n    },\n    renderMsg: function renderMsg(h) {\n      var _vm = this;\n\n      var d = []; // 构建 已选择\n\n      d.push(h('span', {\n        style: {\n          marginRight: '12px'\n        }\n      }, ['已选择 ', h('a', {\n        style: {\n          fontWeight: 600\n        }\n      }, this.selectedRows.length)])); // 构建 列统计\n\n      this.needTotalList.map(function (item) {\n        d.push(h('span', {\n          style: {\n            marginRight: '12px'\n          }\n        }, [\"\".concat(item.title, \"\\u603B\\u8BA1 \"), h('a', {\n          style: {\n            fontWeight: 600\n          }\n        }, \"\".concat(!item.customRender ? item.total : item.customRender(item.total)))]));\n      }); // 构建 清空选择\n\n      d.push(h('a', {\n        style: {\n          marginLeft: '24px'\n        },\n        on: {\n          click: _vm.onClearSelected\n        }\n      }, '清空'));\n      return d;\n    },\n    renderAlert: function renderAlert(h) {\n      return h('span', {\n        slot: 'message'\n      }, this.renderMsg(h));\n    }\n  },\n  render: function render(h) {\n    var _vm = this;\n\n    var props = {},\n        localKeys = Object.keys(this.$data);\n    Object.keys(T.props).forEach(function (k) {\n      var localKey = \"local\".concat(k.substring(0, 1).toUpperCase()).concat(k.substring(1));\n\n      if (localKeys.includes(localKey)) {\n        return props[k] = _vm[localKey];\n      }\n\n      return props[k] = _vm[k];\n    }); // 显示信息提示\n\n    if (this.showAlertInfo) {\n      props.rowSelection = {\n        selectedRowKeys: this.selectedRowKeys,\n        onChange: function onChange(selectedRowKeys, selectedRows) {\n          _vm.updateSelect(selectedRowKeys, selectedRows);\n\n          _vm.$emit('onSelect', {\n            selectedRowKeys: selectedRowKeys,\n            selectedRows: selectedRows\n          });\n        }\n      };\n      return h('div', {}, [h(\"a-alert\", {\n        style: {\n          marginBottom: '16px'\n        },\n        props: {\n          type: 'info',\n          showIcon: true\n        }\n      }, [_vm.renderAlert(h)]), h(\"a-table\", {\n        tag: \"component\",\n        attrs: props,\n        on: {\n          change: _vm.loadData\n        },\n        scopedSlots: this.$scopedSlots\n      }, this.$slots.default)]);\n    }\n\n    return h(\"a-table\", {\n      tag: \"component\",\n      attrs: props,\n      on: {\n        change: _vm.loadData\n      },\n      scopedSlots: this.$scopedSlots\n    }, this.$slots.default);\n  }\n};",{"version":3,"sources":["D:/activiti/project01/jeecg-boot-activiti-master/ant-design-vue-jeecg/src/components/table/index.js"],"names":["T","get","data","needTotalList","selectedRows","selectedRowKeys","localLoading","localDataSource","localPagination","Object","assign","props","pagination","rowKey","type","String","Function","default","required","pageNum","Number","pageSize","showSizeChanger","Boolean","showAlertInfo","showPagination","watch","val","$router","push","name","$route","params","pageNo","current","console","log","created","includes","initTotalList","columns","loadData","methods","refresh","filters","sorter","result","field","sortField","order","sortOrder","Promise","then","r","total","totalCount","totalList","Array","forEach","column","needTotal","updateSelect","list","map","item","reduce","sum","dataIndex","isNaN","updateEdit","onClearSelected","$emit","renderMsg","h","_vm","d","style","marginRight","fontWeight","length","title","customRender","marginLeft","on","click","renderAlert","slot","render","localKeys","keys","$data","k","localKey","substring","toUpperCase","rowSelection","onChange","marginBottom","showIcon","tag","attrs","change","scopedSlots","$scopedSlots","$slots"],"mappings":";;;;;;AAAA,OAAOA,CAAP,MAAc,+BAAd;AACA,OAAOC,GAAP,MAAgB,YAAhB;AACA,eAAe;AACbC,EAAAA,IADa,kBACN;AACL,WAAO;AACLC,MAAAA,aAAa,EAAE,EADV;AAGLC,MAAAA,YAAY,EAAE,EAHT;AAILC,MAAAA,eAAe,EAAE,EAJZ;AAMLC,MAAAA,YAAY,EAAE,KANT;AAOLC,MAAAA,eAAe,EAAE,EAPZ;AAQLC,MAAAA,eAAe,EAAEC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBV,CAAC,CAACW,KAAF,CAAQC,UAA1B;AARZ,KAAP;AAUD,GAZY;AAabD,EAAAA,KAAK,EAAEF,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBV,CAAC,CAACW,KAApB,EAA2B;AAChCE,IAAAA,MAAM,EAAE;AACNC,MAAAA,IAAI,EAAE,CAACC,MAAD,EAASC,QAAT,CADA;AAENC,MAAAA,OAAO,EAAE;AAFH,KADwB;AAKhCf,IAAAA,IAAI,EAAE;AACJY,MAAAA,IAAI,EAAEE,QADF;AAEJE,MAAAA,QAAQ,EAAE;AAFN,KAL0B;AAShCC,IAAAA,OAAO,EAAE;AACPL,MAAAA,IAAI,EAAEM,MADC;AAEPH,MAAAA,OAAO,EAAE;AAFF,KATuB;AAahCI,IAAAA,QAAQ,EAAE;AACRP,MAAAA,IAAI,EAAEM,MADE;AAERH,MAAAA,OAAO,EAAE;AAFD,KAbsB;AAiBhCK,IAAAA,eAAe,EAAE;AACfR,MAAAA,IAAI,EAAES,OADS;AAEfN,MAAAA,OAAO,EAAE;AAFM,KAjBe;AAqBhCO,IAAAA,aAAa,EAAE;AACbV,MAAAA,IAAI,EAAES,OADO;AAEbN,MAAAA,OAAO,EAAE;AAFI,KArBiB;AAyBhCQ,IAAAA,cAAc,EAAE;AACdR,MAAAA,OAAO,EAAE;AADK;AAzBgB,GAA3B,CAbM;AA0CbS,EAAAA,KAAK,EAAE;AACL,6BADK,kCACqBC,GADrB,EAC0B;AAC7B,WAAKC,OAAL,CAAaC,IAAb,CAAkB;AAChBC,QAAAA,IAAI,EAAE,KAAKC,MAAL,CAAYD,IADF;AAEhBE,QAAAA,MAAM,EAAEvB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKqB,MAAL,CAAYC,MAA9B,EAAsC;AAC5CC,UAAAA,MAAM,EAAEN;AADoC,SAAtC;AAFQ,OAAlB;AAMD,KARI;AASLR,IAAAA,OATK,mBASGQ,GATH,EASQ;AACXlB,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKF,eAAnB,EAAoC;AAClC0B,QAAAA,OAAO,EAAEP;AADyB,OAApC;AAGD,KAbI;AAcLN,IAAAA,QAdK,oBAcIM,GAdJ,EAcS;AACZQ,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBT,GAAzB;AACAlB,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKF,eAAnB,EAAoC;AAClCa,QAAAA,QAAQ,EAAEM;AADwB,OAApC;AAGD,KAnBI;AAoBLL,IAAAA,eApBK,2BAoBWK,GApBX,EAoBgB;AACnBQ,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BT,GAA/B;AACAlB,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKF,eAAnB,EAAoC;AAClCc,QAAAA,eAAe,EAAEK;AADiB,OAApC;AAGD;AAzBI,GA1CM;AAqEbU,EAAAA,OArEa,qBAqEH;AACR,SAAK7B,eAAL,GAAuB,CAAC,MAAD,EAAS,IAAT,EAAe8B,QAAf,CAAwB,KAAKb,cAA7B,KAAgDhB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKF,eAAvB,EAAwC;AAC7G0B,MAAAA,OAAO,EAAE,KAAKf,OAD+F;AAE7GE,MAAAA,QAAQ,EAAE,KAAKA,QAF8F;AAG7GC,MAAAA,eAAe,EAAE,KAAKA;AAHuF,KAAxC,CAAvE;AAKA,SAAKnB,aAAL,GAAqB,KAAKoC,aAAL,CAAmB,KAAKC,OAAxB,CAArB;AACA,SAAKC,QAAL;AACD,GA7EY;AA8EbC,EAAAA,OAAO,EAAE;AACPC,IAAAA,OADO,qBACG;AACR,WAAKF,QAAL;AACD,KAHM;AAIPA,IAAAA,QAJO,oBAIE7B,UAJF,EAIcgC,OAJd,EAIuBC,MAJvB,EAI+B;AAAA;;AAEpC,WAAKvC,YAAL,GAAoB,IAApB;AACA,UAAIwC,MAAM,GAAG,KAAK5C,IAAL,CACXO,MAAM,CAACC,MAAP,CAAc;AACVuB,QAAAA,MAAM,EAAGrB,UAAU,IAAIA,UAAU,CAACsB,OAA1B,IACN,KAAK1B,eAAL,CAAqB0B,OAFb;AAGVb,QAAAA,QAAQ,EAAGT,UAAU,IAAIA,UAAU,CAACS,QAA1B,IACR,KAAKb,eAAL,CAAqBa;AAJb,OAAd,EAMGwB,MAAM,IAAIA,MAAM,CAACE,KAAjB,IAA0B;AACzBC,QAAAA,SAAS,EAAEH,MAAM,CAACE;AADO,OAA3B,IAEM,EARR,EASGF,MAAM,IAAIA,MAAM,CAACI,KAAjB,IAA0B;AACzBC,QAAAA,SAAS,EAAEL,MAAM,CAACI;AADO,OAA3B,IAEM,EAXR,oBAYOL,OAZP,EADW,CAAb;;AAkBA,UAAIE,MAAM,YAAYK,OAAtB,EAA+B;AAC7BL,QAAAA,MAAM,CAACM,IAAP,CAAY,UAAAC,CAAC,EAAI;AACf,UAAA,KAAI,CAAC7C,eAAL,GAAuBC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAI,CAACF,eAAvB,EAAwC;AAC7D0B,YAAAA,OAAO,EAAEmB,CAAC,CAACpB,MADkD;AACzC;AACpBqB,YAAAA,KAAK,EAAED,CAAC,CAACE,UAFoD;AAExC;AACrBjC,YAAAA,eAAe,EAAE,KAAI,CAACA,eAHuC;AAI7DD,YAAAA,QAAQ,EAAGT,UAAU,IAAIA,UAAU,CAACS,QAA1B,IACR,KAAI,CAACb,eAAL,CAAqBa;AALsC,WAAxC,CAAvB,CADe,CAQf;;AACA,WAAC,CAAC,KAAI,CAACI,cAAN,IAAwB,CAAC4B,CAAC,CAACE,UAAH,IAAiB,KAAI,CAAC9B,cAAL,KAAwB,MAAlE,MAA8E,KAAI,CAACjB,eAAL,GAAuB,KAArG,EATe,CAUf;;AACA,UAAA,KAAI,CAACD,eAAL,GAAuB8C,CAAC,CAACnD,IAAzB,CAXe,CAWgB;;AAC/B,UAAA,KAAI,CAACI,YAAL,GAAoB,KAApB;AACD,SAbD;AAcD;AACF,KAzCM;AA0CPiC,IAAAA,aA1CO,yBA0COC,OA1CP,EA0CgB;AACrB,UAAMgB,SAAS,GAAG,EAAlB;AACAhB,MAAAA,OAAO,IAAIA,OAAO,YAAYiB,KAA9B,IAAuCjB,OAAO,CAACkB,OAAR,CAAgB,UAAAC,MAAM,EAAI;AAC/D,YAAIA,MAAM,CAACC,SAAX,EAAsB;AACpBJ,UAAAA,SAAS,CAAC3B,IAAV,mBAAoB8B,MAApB;AACEL,YAAAA,KAAK,EAAE;AADT;AAGD;AACF,OANsC,CAAvC;AAOA,aAAOE,SAAP;AACD,KApDM;AAqDPK,IAAAA,YArDO,wBAqDMxD,eArDN,EAqDuBD,YArDvB,EAqDqC;AAC1C,WAAKC,eAAL,GAAuBA,eAAvB;AACA,WAAKD,YAAL,GAAoBA,YAApB;AACA,UAAI0D,IAAI,GAAG,KAAK3D,aAAhB;AACA,WAAKA,aAAL,GAAqB2D,IAAI,CAACC,GAAL,CAAS,UAAAC,IAAI,EAAI;AACpC,iCACKA,IADL;AAEEV,UAAAA,KAAK,EAAElD,YAAY,CAAC6D,MAAb,CAAoB,UAACC,GAAD,EAAMvC,GAAN,EAAc;AACvC,gBAAI2B,KAAK,GAAGY,GAAG,GAAGjE,GAAG,CAAC0B,GAAD,EAAMqC,IAAI,CAACG,SAAX,CAArB;AACA,mBAAOC,KAAK,CAACd,KAAD,CAAL,GAAe,CAAf,GAAmBA,KAA1B;AACD,WAHM,EAGJ,CAHI;AAFT;AAOD,OARoB,CAArB,CAJ0C,CAa1C;AACD,KAnEM;AAoEPe,IAAAA,UApEO,wBAoEM;AACX,WAAKjE,YAAL,GAAoB,EAApB;AACD,KAtEM;AAuEPkE,IAAAA,eAvEO,6BAuEW;AAChB;AACA,WAAKjE,eAAL,GAAuB,EAAvB;AACA,WAAKD,YAAL,GAAoB,EAApB;AACA,WAAKyD,YAAL,CAAkB,EAAlB,EAAsB,EAAtB;AACA,WAAKU,KAAL,CAAW,UAAX;AACD,KA7EM;AA8EPC,IAAAA,SA9EO,qBA8EGC,CA9EH,EA8EM;AACX,UAAMC,GAAG,GAAG,IAAZ;;AACA,UAAIC,CAAC,GAAG,EAAR,CAFW,CAGX;;AACAA,MAAAA,CAAC,CAAC9C,IAAF,CACE4C,CAAC,CAAC,MAAD,EAAS;AACRG,QAAAA,KAAK,EAAE;AACLC,UAAAA,WAAW,EAAE;AADR;AADC,OAAT,EAIE,CAAC,MAAD,EAASJ,CAAC,CAAC,GAAD,EAAM;AACjBG,QAAAA,KAAK,EAAE;AACLE,UAAAA,UAAU,EAAE;AADP;AADU,OAAN,EAIV,KAAK1E,YAAL,CAAkB2E,MAJR,CAAV,CAJF,CADH,EAJW,CAgBX;;AACA,WAAK5E,aAAL,CAAmB4D,GAAnB,CAAuB,UAAAC,IAAI,EAAI;AAC7BW,QAAAA,CAAC,CAAC9C,IAAF,CAAO4C,CAAC,CAAC,MAAD,EAAS;AACbG,UAAAA,KAAK,EAAE;AACLC,YAAAA,WAAW,EAAE;AADR;AADM,SAAT,EAKN,WACMb,IAAI,CAACgB,KADX,oBAEEP,CAAC,CAAC,GAAD,EAAM;AACLG,UAAAA,KAAK,EAAE;AACLE,YAAAA,UAAU,EAAE;AADP;AADF,SAAN,YAIM,CAACd,IAAI,CAACiB,YAAN,GAAqBjB,IAAI,CAACV,KAA1B,GAAkCU,IAAI,CAACiB,YAAL,CAAkBjB,IAAI,CAACV,KAAvB,CAJxC,EAFH,CALM,CAAR;AAaD,OAdD,EAjBW,CAiCX;;AACAqB,MAAAA,CAAC,CAAC9C,IAAF,CAAO4C,CAAC,CAAC,GAAD,EAAM;AACZG,QAAAA,KAAK,EAAE;AACLM,UAAAA,UAAU,EAAE;AADP,SADK;AAIZC,QAAAA,EAAE,EAAE;AACFC,UAAAA,KAAK,EAAEV,GAAG,CAACJ;AADT;AAJQ,OAAN,EAOL,IAPK,CAAR;AASA,aAAOK,CAAP;AACD,KA1HM;AA2HPU,IAAAA,WA3HO,uBA2HKZ,CA3HL,EA2HQ;AACb,aAAOA,CAAC,CAAC,MAAD,EAAS;AACfa,QAAAA,IAAI,EAAE;AADS,OAAT,EAEL,KAAKd,SAAL,CAAeC,CAAf,CAFK,CAAR;AAGD;AA/HM,GA9EI;AAgNbc,EAAAA,MAhNa,kBAgNNd,CAhNM,EAgNH;AACR,QAAMC,GAAG,GAAG,IAAZ;;AAEA,QAAI/D,KAAK,GAAG,EAAZ;AAAA,QACE6E,SAAS,GAAG/E,MAAM,CAACgF,IAAP,CAAY,KAAKC,KAAjB,CADd;AAGAjF,IAAAA,MAAM,CAACgF,IAAP,CAAYzF,CAAC,CAACW,KAAd,EAAqB+C,OAArB,CAA6B,UAAAiC,CAAC,EAAI;AAChC,UAAIC,QAAQ,kBAAWD,CAAC,CAACE,SAAF,CAAY,CAAZ,EAAc,CAAd,EAAiBC,WAAjB,EAAX,SAA4CH,CAAC,CAACE,SAAF,CAAY,CAAZ,CAA5C,CAAZ;;AACA,UAAIL,SAAS,CAAClD,QAAV,CAAmBsD,QAAnB,CAAJ,EAAkC;AAChC,eAAOjF,KAAK,CAACgF,CAAD,CAAL,GAAWjB,GAAG,CAACkB,QAAD,CAArB;AACD;;AACD,aAAOjF,KAAK,CAACgF,CAAD,CAAL,GAAWjB,GAAG,CAACiB,CAAD,CAArB;AACD,KAND,EANQ,CAeR;;AACA,QAAI,KAAKnE,aAAT,EAAwB;AAEtBb,MAAAA,KAAK,CAACoF,YAAN,GAAqB;AACnB1F,QAAAA,eAAe,EAAE,KAAKA,eADH;AAEnB2F,QAAAA,QAAQ,EAAE,kBAAC3F,eAAD,EAAkBD,YAAlB,EAAmC;AAC3CsE,UAAAA,GAAG,CAACb,YAAJ,CAAiBxD,eAAjB,EAAkCD,YAAlC;;AACAsE,UAAAA,GAAG,CAACH,KAAJ,CAAU,UAAV,EAAsB;AAAElE,YAAAA,eAAe,EAAEA,eAAnB;AAAoCD,YAAAA,YAAY,EAAEA;AAAlD,WAAtB;AACD;AALkB,OAArB;AAQA,aAAOqE,CAAC,CAAC,KAAD,EAAQ,EAAR,EAAY,CAClBA,CAAC,CAAC,SAAD,EAAY;AACXG,QAAAA,KAAK,EAAE;AACLqB,UAAAA,YAAY,EAAE;AADT,SADI;AAIXtF,QAAAA,KAAK,EAAE;AACLG,UAAAA,IAAI,EAAE,MADD;AAELoF,UAAAA,QAAQ,EAAE;AAFL;AAJI,OAAZ,EAQE,CAACxB,GAAG,CAACW,WAAJ,CAAgBZ,CAAhB,CAAD,CARF,CADiB,EAUlBA,CAAC,CAAC,SAAD,EAAY;AACX0B,QAAAA,GAAG,EAAE,WADM;AAEXC,QAAAA,KAAK,EAAEzF,KAFI;AAGXwE,QAAAA,EAAE,EAAE;AACFkB,UAAAA,MAAM,EAAE3B,GAAG,CAACjC;AADV,SAHO;AAMX6D,QAAAA,WAAW,EAAE,KAAKC;AANP,OAAZ,EAOE,KAAKC,MAAL,CAAYvF,OAPd,CAViB,CAAZ,CAAR;AAoBD;;AAED,WAAOwD,CAAC,CAAC,SAAD,EAAY;AAClB0B,MAAAA,GAAG,EAAE,WADa;AAElBC,MAAAA,KAAK,EAAEzF,KAFW;AAGlBwE,MAAAA,EAAE,EAAE;AACFkB,QAAAA,MAAM,EAAE3B,GAAG,CAACjC;AADV,OAHc;AAMlB6D,MAAAA,WAAW,EAAE,KAAKC;AANA,KAAZ,EAOL,KAAKC,MAAL,CAAYvF,OAPP,CAAR;AASD;AAzQY,CAAf","sourcesContent":["import T from \"ant-design-vue/es/table/Table\";\nimport get from \"lodash.get\"\nexport default {\n  data() {\n    return {\n      needTotalList: [],\n\n      selectedRows: [],\n      selectedRowKeys: [],\n\n      localLoading: false,\n      localDataSource: [],\n      localPagination: Object.assign({}, T.props.pagination)\n    };\n  },\n  props: Object.assign({}, T.props, {\n    rowKey: {\n      type: [String, Function],\n      default: 'id'\n    },\n    data: {\n      type: Function,\n      required: true\n    },\n    pageNum: {\n      type: Number,\n      default: 1\n    },\n    pageSize: {\n      type: Number,\n      default: 10\n    },\n    showSizeChanger: {\n      type: Boolean,\n      default: true\n    },\n    showAlertInfo: {\n      type: Boolean,\n      default: false\n    },\n    showPagination: {\n      default: 'auto'\n    }\n  }),\n  watch: {\n    'localPagination.current'(val) {\n      this.$router.push({\n        name: this.$route.name,\n        params: Object.assign({}, this.$route.params, {\n          pageNo: val\n        }),\n      });\n    },\n    pageNum(val) {\n      Object.assign(this.localPagination, {\n        current: val\n      });\n    },\n    pageSize(val) {\n      console.log('pageSize:', val)\n      Object.assign(this.localPagination, {\n        pageSize: val\n      });\n    },\n    showSizeChanger(val) {\n      console.log('showSizeChanger', val)\n      Object.assign(this.localPagination, {\n        showSizeChanger: val\n      });\n    }\n  },\n  created() {\n    this.localPagination = ['auto', true].includes(this.showPagination) && Object.assign({}, this.localPagination, {\n      current: this.pageNum,\n      pageSize: this.pageSize,\n      showSizeChanger: this.showSizeChanger\n    });\n    this.needTotalList = this.initTotalList(this.columns)\n    this.loadData();\n  },\n  methods: {\n    refresh() {\n      this.loadData();\n    },\n    loadData(pagination, filters, sorter) {\n\n      this.localLoading = true\n      var result = this.data(\n        Object.assign({\n            pageNo: (pagination && pagination.current) ||\n              this.localPagination.current,\n            pageSize: (pagination && pagination.pageSize) ||\n              this.localPagination.pageSize\n          },\n          (sorter && sorter.field && {\n            sortField: sorter.field\n          }) || {},\n          (sorter && sorter.order && {\n            sortOrder: sorter.order\n          }) || {}, {\n            ...filters\n          }\n        )\n      );\n\n      if (result instanceof Promise) {\n        result.then(r => {\n          this.localPagination = Object.assign({}, this.localPagination, {\n            current: r.pageNo,  // 返回结果中的当前分页数\n            total: r.totalCount, // 返回结果中的总记录数\n            showSizeChanger: this.showSizeChanger,\n            pageSize: (pagination && pagination.pageSize) ||\n              this.localPagination.pageSize\n          });\n          //update--begin--autor:wangshuai-----date:20200724------for：判断showPagination是否为false------\n          (!this.showPagination || !r.totalCount && this.showPagination === 'auto') && (this.localPagination = false)\n          //update--end--autor:wangshuai-----date:20200724------for：判断showPagination是否为false-----\n          this.localDataSource = r.data; // 返回结果中的数组数据\n          this.localLoading = false\n        });\n      }\n    },\n    initTotalList(columns) {\n      const totalList = []\n      columns && columns instanceof Array && columns.forEach(column => {\n        if (column.needTotal) {\n          totalList.push({ ...column,\n            total: 0\n          })\n        }\n      })\n      return totalList\n    },\n    updateSelect(selectedRowKeys, selectedRows) {\n      this.selectedRowKeys = selectedRowKeys\n      this.selectedRows = selectedRows\n      let list = this.needTotalList\n      this.needTotalList = list.map(item => {\n        return {\n          ...item,\n          total: selectedRows.reduce((sum, val) => {\n            let total = sum + get(val, item.dataIndex)\n            return isNaN(total) ? 0 : total\n          }, 0)\n        }\n      })\n      // this.$emit('change', selectedRowKeys, selectedRows)\n    },\n    updateEdit() {\n      this.selectedRows = []\n    },\n    onClearSelected() {\n      // 【TESTA-262】页面清空后还能才做所选行，增加  this.$emit('clearAll')\n      this.selectedRowKeys = []\n      this.selectedRows = []\n      this.updateSelect([], [])\n      this.$emit('clearAll')\n    },\n    renderMsg(h) {\n      const _vm = this\n      let d = []\n      // 构建 已选择\n      d.push(\n        h('span', {\n          style: {\n            marginRight: '12px'\n          }\n        }, ['已选择 ', h('a', {\n          style: {\n            fontWeight: 600\n          }\n        }, this.selectedRows.length)])\n      );\n\n      // 构建 列统计\n      this.needTotalList.map(item => {\n        d.push(h('span', {\n            style: {\n              marginRight: '12px'\n            }\n          },\n          [\n            `${ item.title }总计 `,\n            h('a', {\n              style: {\n                fontWeight: 600\n              }\n            }, `${ !item.customRender ? item.total : item.customRender(item.total) }`)\n          ]))\n      });\n\n      // 构建 清空选择\n      d.push(h('a', {\n        style: {\n          marginLeft: '24px'\n        },\n        on: {\n          click: _vm.onClearSelected\n        }\n      }, '清空'))\n\n      return d\n    },\n    renderAlert(h) {\n      return h('span', {\n        slot: 'message'\n      }, this.renderMsg(h))\n    },\n  },\n\n  render(h) {\n    const _vm = this\n\n    let props = {},\n      localKeys = Object.keys(this.$data);\n\n    Object.keys(T.props).forEach(k => {\n      let localKey = `local${k.substring(0,1).toUpperCase()}${k.substring(1)}`;\n      if (localKeys.includes(localKey)) {\n        return props[k] = _vm[localKey];\n      }\n      return props[k] = _vm[k];\n    })\n\n\n    // 显示信息提示\n    if (this.showAlertInfo) {\n\n      props.rowSelection = {\n        selectedRowKeys: this.selectedRowKeys,\n        onChange: (selectedRowKeys, selectedRows) => {\n          _vm.updateSelect(selectedRowKeys, selectedRows)\n          _vm.$emit('onSelect', { selectedRowKeys: selectedRowKeys, selectedRows: selectedRows })\n        }\n      };\n\n      return h('div', {}, [\n        h(\"a-alert\", {\n          style: {\n            marginBottom: '16px'\n          },\n          props: {\n            type: 'info',\n            showIcon: true\n          }\n        }, [_vm.renderAlert(h)]),\n        h(\"a-table\", {\n          tag: \"component\",\n          attrs: props,\n          on: {\n            change: _vm.loadData\n          },\n          scopedSlots: this.$scopedSlots\n        }, this.$slots.default)\n      ]);\n\n    }\n\n    return h(\"a-table\", {\n      tag: \"component\",\n      attrs: props,\n      on: {\n        change: _vm.loadData\n      },\n      scopedSlots: this.$scopedSlots\n    }, this.$slots.default);\n\n  }\n};"]}]}