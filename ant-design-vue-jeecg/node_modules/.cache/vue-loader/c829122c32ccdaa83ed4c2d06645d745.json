{"remainingRequest":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\activiti\\form\\demoForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\activiti\\form\\demoForm.vue","mtime":1621951625893},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1621061372054}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport pick from \"lodash.pick\";\n\nexport default {\n  name: 'demoForm',\n  props:{\n    /*全局禁用，可表示查看*/\n    disabled:{\n      type:Boolean,\n      default:false,\n      required:false\n    },\n    /*流程数据*/\n    processData:{\n      type:Object,\n      default:()=>{return {}},\n      required:false\n    },\n    /*是否新增*/\n    isNew: {type: Boolean, default: false, required: false},\n    /*是否处理流程*/\n    task: {type: Boolean, default: false, required: false}\n  },\n  data () {\n    return {\n      url:{\n        getForm:'/actBusiness/getForm',\n        addApply:'/actBusiness/add',\n        editForm:'/actBusiness/editForm',\n      },\n      description: '流程表单demo，按例开发表单。需在 activitiMixin.js 中加入写好的表单',\n      // form\n      form: this.$form.createForm(this),\n      /*表单回显数据*/\n      data:{},\n      btndisabled: false\n    }\n  },\n  created() {\n    console.log(\"流程数据\",this.processData)\n    if (!this.isNew){\n      this.init();\n    }\n  },\n  methods: {\n    /*回显数据*/\n    init(){\n      this.btndisabled = true;\n      var r = this.processData;\n      this.getAction(this.url.getForm,{\n        tableId:r.tableId,\n        tableName:r.tableName,\n      }).then((res)=>{\n        if (res.success){\n          let formData = res.result;\n          formData.tableName = r.tableName;\n          this.data = formData;\n          console.log(\"表单回显数据\",this.data)\n          this.$nextTick(() => {\n            this.form.setFieldsValue(pick(this.data,'name'))\n          });\n          this.btndisabled = false;\n        }else {\n          this.$message.error(res.message)\n        }\n      })\n    },\n    // handler\n    handleSubmit (e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          let formData = Object.assign(this.data||{}, values)\n          formData.procDefId = this.processData.id;\n          formData.procDeTitle = this.processData.name;\n          if (!formData.tableName)formData.tableName = this.processData.businessTable;\n          formData.filedNames = _.keys(values).join(\",\");\n          console.log('formData', values)\n          var url = this.url.addApply;\n          if (!this.isNew){\n            url = this.url.editForm;\n          }\n          this.btndisabled = true;\n          this.postFormAction(url,formData).then((res)=>{\n            if (res.success){\n              this.$message.success(\"保存成功！\")\n              //todo 将表单的数据传给父组件\n              this.$emit('afterSubmit',formData)\n            }else {\n              this.$message.error(res.message)\n            }\n          }).finally(()=>{\n            this.btndisabled = false;\n          })\n        }\n      })\n    },\n    close() {\n      //todo 关闭后的回调\n      this.$emit('close')\n    },\n    /*通过审批*/\n    passTask() {\n      this.$emit('passTask')\n    },\n    /*驳回审批*/\n    backTask() {\n      this.$emit('backTask')\n    }\n  }\n}\n",{"version":3,"sources":["demoForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"demoForm.vue","sourceRoot":"src/views/activiti/form","sourcesContent":["<template>\r\n  <!--流程业务表单-->\r\n  <div class=\"form-main\">\r\n    <a-card :body-style=\"{padding: '24px 32px'}\" :bordered=\"false\">\r\n      <a-form @submit=\"handleSubmit\" :form=\"form\">\r\n        <a-form-item\r\n          label=\"请假类型\"\r\n          :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n          :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\r\n          <a-input :disabled=\"disabled\"\r\n                   v-decorator=\"[\r\n            'name',\r\n            {rules: [{ required: true, message: '请输入请假类型' }]}\r\n          ]\"\r\n                   name=\"name\"\r\n                   placeholder=\"请输入请假类型\" />\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"请假事由\"\r\n          :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n          :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\r\n          <a-textarea :disabled=\"disabled\"\r\n            rows=\"4\"\r\n            placeholder=\"请输入请假事由\"\r\n            v-decorator=\"[\r\n            'descc',\r\n            {rules: [{ required: true, message: '请输入请假事由' }]}\r\n          ]\" />\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"年龄\"\r\n          :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n          :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n          :required=\"false\"\r\n        >\r\n          <a-input\r\n            placeholder=\"请输入您的年龄\"\r\n            v-decorator=\"[\r\n            'age',\r\n            {rules: [{ required: true, message: '请输入您的年龄' }]}\r\n          ]\" />\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"请假期间工作处理\"\r\n          :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n          :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\r\n          <a-textarea :disabled=\"disabled\"\r\n            rows=\"4\"\r\n            placeholder=\"请输入工作处理\"\r\n            v-decorator=\"[\r\n            'chegnshi',\r\n            {rules: [{ required: true, message: '请输入工作处理' }]}\r\n          ]\" />\r\n        </a-form-item>\r\n        <a-form-item v-if=\"!disabled\"\r\n                     :wrapperCol=\"{ span: 24 }\"\r\n                     style=\"text-align: center\"\r\n        >\r\n          <a-button type=\"primary\" :disabled=\"disabled||btndisabled\" @click=\"handleSubmit\">保存</a-button>\r\n          <a-button style=\"margin-left: 8px\" :disabled=\"disabled\" @click=\"close\">取消</a-button>\r\n        </a-form-item>\r\n        <a-form-item v-if=\"task\"\r\n                     :wrapperCol=\"{ span: 24 }\"\r\n                     style=\"text-align: center\"\r\n        >\r\n          <a-button type=\"primary\"  @click=\"passTask\">通过</a-button>\r\n          <a-button style=\"margin-left: 8px\"  @click=\"backTask\">驳回</a-button>\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import pick from \"lodash.pick\";\r\n\r\n  export default {\r\n    name: 'demoForm',\r\n    props:{\r\n      /*全局禁用，可表示查看*/\r\n      disabled:{\r\n        type:Boolean,\r\n        default:false,\r\n        required:false\r\n      },\r\n      /*流程数据*/\r\n      processData:{\r\n        type:Object,\r\n        default:()=>{return {}},\r\n        required:false\r\n      },\r\n      /*是否新增*/\r\n      isNew: {type: Boolean, default: false, required: false},\r\n      /*是否处理流程*/\r\n      task: {type: Boolean, default: false, required: false}\r\n    },\r\n    data () {\r\n      return {\r\n        url:{\r\n          getForm:'/actBusiness/getForm',\r\n          addApply:'/actBusiness/add',\r\n          editForm:'/actBusiness/editForm',\r\n        },\r\n        description: '流程表单demo，按例开发表单。需在 activitiMixin.js 中加入写好的表单',\r\n        // form\r\n        form: this.$form.createForm(this),\r\n        /*表单回显数据*/\r\n        data:{},\r\n        btndisabled: false\r\n      }\r\n    },\r\n    created() {\r\n      console.log(\"流程数据\",this.processData)\r\n      if (!this.isNew){\r\n        this.init();\r\n      }\r\n    },\r\n    methods: {\r\n      /*回显数据*/\r\n      init(){\r\n        this.btndisabled = true;\r\n        var r = this.processData;\r\n        this.getAction(this.url.getForm,{\r\n          tableId:r.tableId,\r\n          tableName:r.tableName,\r\n        }).then((res)=>{\r\n          if (res.success){\r\n            let formData = res.result;\r\n            formData.tableName = r.tableName;\r\n            this.data = formData;\r\n            console.log(\"表单回显数据\",this.data)\r\n            this.$nextTick(() => {\r\n              this.form.setFieldsValue(pick(this.data,'name'))\r\n            });\r\n            this.btndisabled = false;\r\n          }else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n      },\r\n      // handler\r\n      handleSubmit (e) {\r\n        e.preventDefault()\r\n        this.form.validateFields((err, values) => {\r\n          if (!err) {\r\n            let formData = Object.assign(this.data||{}, values)\r\n            formData.procDefId = this.processData.id;\r\n            formData.procDeTitle = this.processData.name;\r\n            if (!formData.tableName)formData.tableName = this.processData.businessTable;\r\n            formData.filedNames = _.keys(values).join(\",\");\r\n            console.log('formData', values)\r\n            var url = this.url.addApply;\r\n            if (!this.isNew){\r\n              url = this.url.editForm;\r\n            }\r\n            this.btndisabled = true;\r\n            this.postFormAction(url,formData).then((res)=>{\r\n              if (res.success){\r\n                this.$message.success(\"保存成功！\")\r\n                //todo 将表单的数据传给父组件\r\n                this.$emit('afterSubmit',formData)\r\n              }else {\r\n                this.$message.error(res.message)\r\n              }\r\n            }).finally(()=>{\r\n              this.btndisabled = false;\r\n            })\r\n          }\r\n        })\r\n      },\r\n      close() {\r\n        //todo 关闭后的回调\r\n        this.$emit('close')\r\n      },\r\n      /*通过审批*/\r\n      passTask() {\r\n        this.$emit('passTask')\r\n      },\r\n      /*驳回审批*/\r\n      backTask() {\r\n        this.$emit('backTask')\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"less\" scoped>\r\n  .form-main{\r\n  }\r\n</style>"]}]}