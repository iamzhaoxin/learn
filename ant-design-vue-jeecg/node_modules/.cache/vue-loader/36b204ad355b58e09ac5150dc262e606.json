{"remainingRequest":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\system\\modules\\DeptRoleUserModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\src\\views\\system\\modules\\DeptRoleUserModal.vue","mtime":1611914356000},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1621061377995},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1621061384845},{"path":"D:\\activiti\\project01\\jeecg-boot-activiti-master\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1621061372054}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {httpAction, getAction} from '@/api/manage'\nimport  JEllipsis  from '@/components/jeecg/JEllipsis'\nimport {initDictOptions} from '@/components/dict/JDictSelectUtil'\n\nexport default {\n  name: 'DeptRoleUserModal',\n  components: {\n    JEllipsis\n  },\n  data() {\n    return {\n      currentDeptId:\"\",\n      title: \"部门角色分配\",\n      visible: false,\n      model: {},\n      labelCol: {\n        xs: {span: 24},\n        sm: {span: 5},\n      },\n      wrapperCol: {\n        xs: {span: 24},\n        sm: {span: 16},\n      },\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      validatorRules: {},\n      url: {\n        add: \"/sys/sysDepartRole/deptRoleUserAdd\",\n        getDeptRoleList:\"/sys/sysDepartRole/getDeptRoleList\",\n        getDeptRoleByUserId:\"/sys/sysDepartRole/getDeptRoleByUserId\"\n      },\n      designNameOption: [],\n      userId: \"\",\n      newRoleId:\"\",\n      oldRoleId:\"\",\n      designNameValue:[],\n      desformList: [],\n    }\n  },\n  created() {\n\n  },\n  methods: {\n    add(record,departId) {\n      this.userId = record.id;\n      this.currentDeptId = departId;\n      this.loadDesformList();\n      this.edit({});\n    },\n    edit(record) {\n      this.form.resetFields();\n      this.model = Object.assign({}, record);\n      this.visible = true;\n      getAction(this.url.getDeptRoleByUserId,{userId:this.userId,departId:this.currentDeptId}).then((res) => {\n        if (res.success) {\n          var designName = [];\n          for (let value of res.result) {\n            designName.push(value.droleId)\n          }\n          this.oldRoleId=designName.join(\",\");\n          this.designNameValue = designName;\n          this.newRoleId = designName.join(\",\");\n        }\n      });\n    },\n    close() {\n      this.$emit('close');\n      this.visible = false;\n    },\n    handleSubmit() {\n      const that = this;\n      // 触发表单验证\n      that.confirmLoading = true;\n      let  httpurl = this.url.add;\n      let  method = 'post';\n      let formData = Object.assign(this.model, {});\n      //时间格式化\n      formData.userId = this.userId;\n      formData.newRoleId=this.newRoleId;\n      formData.oldRoleId=this.oldRoleId;\n      httpAction(httpurl, formData, method).then((res) => {\n        if (res.success) {\n          that.$message.success(res.message);\n          that.$emit('reload');\n          that.$emit('ok');\n        } else {\n          that.$message.warning(res.message);\n        }\n      }).finally(() => {\n        that.confirmLoading = false;\n        that.close();\n      })\n    },\n    handleCancel() {\n      this.designNameOption=[];\n      this.designNameValue=[];\n      this.close()\n    },\n    designNameChange(selectedValue) {\n      this.newRoleId=selectedValue.join(\",\");\n    },\n    checkALL(){\n      var designName = [];\n      for (let value of this.desformList) {\n        designName.push(\n          value.id\n        )\n      }\n      this.designNameValue = designName;\n      this.newRoleId=designName.join(\",\");\n    },\n    cancelCheckALL(){\n      this.designNameValue=[];\n      this.newRoleId=\"\";\n    },\n    /** 加载desform */\n    loadDesformList() {\n      getAction(this.url.getDeptRoleList, { departId: this.currentDeptId, userId:this.userId }).then((res) => {\n        if (res.success) {\n          this.desformList = res.result\n          var designName = [];\n          for (let value of this.desformList) {\n            designName.push({\n              value: value.id,\n              text: value.roleName,\n            })\n          }\n          this.designNameOption = designName;\n        }\n      });\n    },\n  }\n\n}\n",{"version":3,"sources":["DeptRoleUserModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"DeptRoleUserModal.vue","sourceRoot":"src/views/system/modules","sourcesContent":["<template>\n  <a-drawer\n    :title=\"title\"\n    :maskClosable=\"true\"\n    width=600\n    placement=\"right\"\n    :closable=\"true\"\n    @close=\"close\"\n    :visible=\"visible\"\n    style=\"overflow: auto;padding-bottom: 53px;\">\n\n    <a-spin :spinning=\"confirmLoading\">\n\n      <a-form :form=\"form\" v-if=\"designNameOption.length>0\">\n        <a-form-item label=''>\n          <a-col :xl=\"24\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\">\n            <a-card :style=\"{ marginTop: '12px',height:'auto' }\">\n              <a-checkbox-group @change=\"designNameChange\" v-model=\"designNameValue\" style=\"width: 100%\">\n                <a-row>\n                  <template v-for=\"(des) in designNameOption\">\n                    <a-col :span=\"6\">\n                      <a-checkbox :value=\"des.value\">{{ des.text }}</a-checkbox>\n                    </a-col>\n                  </template>\n                </a-row>\n              </a-checkbox-group>\n            </a-card>\n          </a-col>\n        </a-form-item>\n      </a-form>\n      <div v-else><h3>无可配置角色!</h3></div>\n    </a-spin>\n    <div class=\"drawer-bootom-button\">\n      <a-dropdown style=\"float: left\" :trigger=\"['click']\" placement=\"topCenter\">\n        <a-menu slot=\"overlay\">\n          <a-menu-item key=\"1\" @click=\"checkALL\">全部勾选</a-menu-item>\n          <a-menu-item key=\"2\" @click=\"cancelCheckALL\">取消全选</a-menu-item>\n        </a-menu>\n        <a-button>\n          操作 <a-icon type=\"up\" />\n        </a-button>\n      </a-dropdown>\n      <a-popconfirm  title=\"确定放弃编辑？\" @confirm=\"close\" okText=\"确定\" cancelText=\"取消\">\n        <a-button style=\"margin-right: .8rem\">取消</a-button>\n      </a-popconfirm>\n      <a-button @click=\"handleSubmit(true)\" type=\"primary\">保存</a-button>\n    </div>\n  </a-drawer>\n</template>\n\n<script>\n  import {httpAction, getAction} from '@/api/manage'\n  import  JEllipsis  from '@/components/jeecg/JEllipsis'\n  import {initDictOptions} from '@/components/dict/JDictSelectUtil'\n\n  export default {\n    name: 'DeptRoleUserModal',\n    components: {\n      JEllipsis\n    },\n    data() {\n      return {\n        currentDeptId:\"\",\n        title: \"部门角色分配\",\n        visible: false,\n        model: {},\n        labelCol: {\n          xs: {span: 24},\n          sm: {span: 5},\n        },\n        wrapperCol: {\n          xs: {span: 24},\n          sm: {span: 16},\n        },\n        confirmLoading: false,\n        form: this.$form.createForm(this),\n        validatorRules: {},\n        url: {\n          add: \"/sys/sysDepartRole/deptRoleUserAdd\",\n          getDeptRoleList:\"/sys/sysDepartRole/getDeptRoleList\",\n          getDeptRoleByUserId:\"/sys/sysDepartRole/getDeptRoleByUserId\"\n        },\n        designNameOption: [],\n        userId: \"\",\n        newRoleId:\"\",\n        oldRoleId:\"\",\n        designNameValue:[],\n        desformList: [],\n      }\n    },\n    created() {\n\n    },\n    methods: {\n      add(record,departId) {\n        this.userId = record.id;\n        this.currentDeptId = departId;\n        this.loadDesformList();\n        this.edit({});\n      },\n      edit(record) {\n        this.form.resetFields();\n        this.model = Object.assign({}, record);\n        this.visible = true;\n        getAction(this.url.getDeptRoleByUserId,{userId:this.userId,departId:this.currentDeptId}).then((res) => {\n          if (res.success) {\n            var designName = [];\n            for (let value of res.result) {\n              designName.push(value.droleId)\n            }\n            this.oldRoleId=designName.join(\",\");\n            this.designNameValue = designName;\n            this.newRoleId = designName.join(\",\");\n          }\n        });\n      },\n      close() {\n        this.$emit('close');\n        this.visible = false;\n      },\n      handleSubmit() {\n        const that = this;\n        // 触发表单验证\n        that.confirmLoading = true;\n        let  httpurl = this.url.add;\n        let  method = 'post';\n        let formData = Object.assign(this.model, {});\n        //时间格式化\n        formData.userId = this.userId;\n        formData.newRoleId=this.newRoleId;\n        formData.oldRoleId=this.oldRoleId;\n        httpAction(httpurl, formData, method).then((res) => {\n          if (res.success) {\n            that.$message.success(res.message);\n            that.$emit('reload');\n            that.$emit('ok');\n          } else {\n            that.$message.warning(res.message);\n          }\n        }).finally(() => {\n          that.confirmLoading = false;\n          that.close();\n        })\n      },\n      handleCancel() {\n        this.designNameOption=[];\n        this.designNameValue=[];\n        this.close()\n      },\n      designNameChange(selectedValue) {\n        this.newRoleId=selectedValue.join(\",\");\n      },\n      checkALL(){\n        var designName = [];\n        for (let value of this.desformList) {\n          designName.push(\n            value.id\n          )\n        }\n        this.designNameValue = designName;\n        this.newRoleId=designName.join(\",\");\n      },\n      cancelCheckALL(){\n        this.designNameValue=[];\n        this.newRoleId=\"\";\n      },\n      /** 加载desform */\n      loadDesformList() {\n        getAction(this.url.getDeptRoleList, { departId: this.currentDeptId, userId:this.userId }).then((res) => {\n          if (res.success) {\n            this.desformList = res.result\n            var designName = [];\n            for (let value of this.desformList) {\n              designName.push({\n                value: value.id,\n                text: value.roleName,\n              })\n            }\n            this.designNameOption = designName;\n          }\n        });\n      },\n    }\n\n  }\n</script>\n\n<style scoped>\n  .drawer-bootom-button {\n    position: absolute;\n    bottom: 0;\n    width: 100%;\n    border-top: 1px solid #e8e8e8;\n    padding: 10px 16px;\n    text-align: right;\n    left: 0;\n    background: #fff;\n    border-radius: 0 0 2px 2px;\n  }\n</style>"]}]}